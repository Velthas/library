/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={426:(e,t,n)=>{n.d(t,{Z:()=>a});var r=n(81),i=n.n(r),s=n(645),o=n.n(s)()(i());o.push([e.id,"* {\r\n    box-sizing: border-box;\r\n    margin: 0;\r\n    padding: 0;\r\n}\r\n\r\nbody {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    gap: 12px;\r\n\r\n    background-color: #c38f52;\r\n    color: #e6edef;\r\n}\r\n\r\n#header button {\r\n    padding: 10px 20px;\r\n    background-color: #fdfffa;\r\n    color: #c38f52;\r\n    transition: 0.3s;\r\n    border: none;\r\n    border-radius: 3px;\r\n}\r\n\r\n#header button:hover {\r\n    background-color: #c38f52;\r\n    color: #fdfffa;\r\n    border: 1px solid white;\r\n}\r\n\r\n#header {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n\r\n    margin: 25px 0px;\r\n    gap: 5vh;\r\n\r\n    font-size: 30px;\r\n    font-family: 'Bebas Neue', cursive;\r\n    color: #fdfffa;\r\n}\r\n\r\n#header p {\r\n    text-align: center;\r\n    width: 40vw;\r\n\r\n    color: #fdfffa;\r\n    font-family: 'Lobster', cursive;\r\n    font-size: 25px;\r\n}\r\n\r\n#settings {\r\n    display:flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n\r\n    margin-top: 20px;\r\n}\r\n\r\n#user-info {\r\n    display: flex;\r\n    flex-direction: column;\r\n    align-items: center;\r\n    justify-content: center;\r\n}\r\n\r\n#user-info img {\r\n    width: 50px;\r\n    border-radius: 25px;\r\n}\r\n\r\n\r\n.bubble {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n\r\n    width: 85px;\r\n    height: 85px;\r\n    margin: 30px 0;\r\n\r\n    font-weight: 600;\r\n    font-size: 100px;\r\n\r\n    background-color: #783320;\r\n    color: #fffeff;\r\n\r\n    border-radius: 50px;\r\n    cursor: pointer;\r\n}\r\n\r\n.bubble:hover,\r\n.submit:hover {\r\n    transition: transform ease 0.3s;\r\n    transform: translateY(-5px);\r\n}\r\n\r\n#formWindow {\r\n    width: 350px;\r\n    height: 500px;\r\n    position: fixed;\r\n    transform: translate(-50%, -50%);\r\n    left: 50%;\r\n    top: 50%;\r\n\r\n    background-color: white;\r\n    box-shadow: #383535 2px 2px 12px 3px;\r\n\r\n    opacity: 100%;\r\n    border-radius: 15px;\r\n\r\n}\r\n\r\n#formBackdrop {\r\n    position: fixed;\r\n    height: 100%;\r\n    width: 100%;\r\n\r\n    background-color: rgba(0, 0, 0, 0.4);\r\n}\r\n\r\n#formBackdrop.hidden {\r\n    display: none;\r\n}\r\n\r\n.formContainer {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n    gap: 24px;\r\n\r\n    color: black;\r\n\r\n    padding: 16px;\r\n}\r\n\r\n.formContainer img {\r\n    height:25px;\r\n    align-self: flex-end;\r\n    transition: filter ease 0.3s;\r\n}\r\n\r\n.formContainer img:hover {\r\n    filter: brightness(80%);\r\n}\r\n\r\nlabel,\r\nform {\r\n    display: block;\r\n}\r\n\r\n.formContainer form {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items: center;\r\n\r\n    text-align: center;\r\n\r\n    height: 350px;\r\n    width: 350px;\r\n\r\n    color: black;\r\n    font-size: 18px;\r\n}\r\n\r\n.formContainer input {\r\n    width: 300px;\r\n    height: 50px;\r\n    font-size: 15px;\r\n\r\n    border: none;\r\n    border-radius: 5px;\r\n\r\n    padding: 10px;\r\n    margin: 5px 0px 16px 0px;\r\n\r\n    background-color: #efd4ad;\r\n    color: #85673a;\r\n}\r\n\r\ninput::placeholder {\r\n    color: #78878a\r\n}\r\n\r\nbutton.submit{\r\n    width: 35px;\r\n    height: 35px;\r\n\r\n    background-color: #783320;\r\n    color: #e6edef;\r\n\r\n    border-radius: 50px;\r\n    border: none;\r\n\r\n    cursor: pointer;\r\n    font-size: 20px;\r\n    font-weight: bold;\r\n}\r\n\r\n#library {\r\n    display: flex;\r\n    justify-content: space-around;\r\n    flex-wrap: wrap;\r\n    gap: 80px;\r\n\r\n    width: 100%;\r\n    padding: 40px 60px 90px 15px;\r\n\r\n    \r\n}\r\n\r\n.book {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: space-around;\r\n    align-items:center;\r\n\r\n    width: 250px;\r\n    height: 300px;\r\n\r\n    font-family: 'Lobster', cursive;\r\n    border-top-left-radius: 16px;\r\n}\r\n\r\n.shadowOne {\r\n    background-color: #b3b28b;\r\n    box-shadow: 15px -10px 0px 0px snow,\r\n    25px -15px 0px 0px lightgrey,\r\n    0px -20px 0px 0px #b3b28b,\r\n    35px -20px 0px 0px #b3b28b;\r\n}\r\n\r\n.shadowTwo{\r\n    background-color: #b4a3d2;\r\n    box-shadow: 15px -10px 0px 0px snow,\r\n    25px -15px 0px 0px lightgrey,\r\n    0px -20px 0px 0px #b4a3d2,\r\n    35px -20px 0px 0px #b4a3d2;\r\n}\r\n\r\n.shadowThree{\r\n    background-color: #2b2c56;\r\n    box-shadow: 15px -10px 0px 0px snow,\r\n    25px -15px 0px 0px lightgrey,\r\n    0px -20px 0px 0px #2b2c56,\r\n    35px -20px 0px 0px #2b2c56;\r\n}\r\n\r\n.book button {\r\n    width: 35px;\r\n    height: 35px;\r\n\r\n    color: #e6edef;\r\n\r\n    border-radius: 50px;\r\n    border: none;\r\n    cursor: pointer;\r\n\r\n    font-size: 20px;\r\n    font-weight: bold;\r\n}\r\n\r\n.shadowOne button {\r\n    background-color: #839b69;\r\n}\r\n\r\n.shadowTwo button {\r\n    background-color: #847899;\r\n}\r\n\r\n.shadowThree button {\r\n    background-color: #151538;\r\n}\r\n\r\n.book img {\r\n    height: 100px;\r\n}\r\n.center {\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n.book p {\r\n    font-size: 25px;\r\n}\r\n\r\n.book p.title {\r\n    font-size: 30px;\r\n    text-align: center;\r\n}\r\n\r\np.progress {\r\n    display: inline;\r\n    margin: 10px;\r\n}\r\n\r\n#error{\r\n    display: block;\r\n\r\n    border-radius: 10px;\r\n\r\n    background-color: #fe4c61;\r\n    color: #ffc0c5;\r\n\r\n    height: auto;\r\n    width: 45vw;\r\n    padding: 8px;\r\n    margin: 16px;\r\n}\r\n\r\n#error.hidden {\r\n    display: none;\r\n}\r\n\r\n.deleteBook {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n\r\n    width: 25px;\r\n    height: 25px;\r\n    margin: 5px 25px 0px 0px;\r\n\r\n    align-self: flex-end;\r\n\r\n    background-color: #c42020;\r\n    border-radius: 12px;\r\n    cursor: pointer;\r\n\r\n    font-weight: bold;\r\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\r\n    text-transform: uppercase;\r\n}\r\n\r\n.deleteBook:hover {\r\n    background-color: maroon;\r\n}\r\n\r\n@media screen and (max-width: 700px) {\r\n    #header {\r\n        font-size: 20px;\r\n        margin-bottom: 0\r\n    }\r\n\r\n    #header p {\r\n        font-size: 15px;\r\n        width: 60vw\r\n    }\r\n\r\n    .bubble {\r\n        width: 50px;\r\n        height: 50px;\r\n        font-size: 30px;\r\n        margin-top: 0;\r\n    }\r\n\r\n    #formWindow {\r\n        width: 280px;\r\n        height: 450px;\r\n    }\r\n\r\n    .formContainer {\r\n        gap: 0px;\r\n    }\r\n\r\n    .formContainer form {\r\n        font-size: 15px;\r\n        width: 250px;\r\n    }\r\n\r\n    .formContainer input {\r\n        width: 200px;\r\n        font-size: 12px;\r\n    }\r\n\r\n}\r\n\r\n@media screen and (max-width: 210px) {\r\n    #settings {\r\n        margin-top: 30px;\r\n    }\r\n\r\n    #header p {\r\n        width: 100vw;\r\n        font-size: 12\r\n    }\r\n}",""]);const a=o},645:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,i,s){"string"==typeof e&&(e=[[null,e,void 0]]);var o={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(o[c]=!0)}for(var u=0;u<e.length;u++){var h=[].concat(e[u]);r&&o[h[0]]||(void 0!==s&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=s),n&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=n):h[2]=n),i&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=i):h[4]="".concat(i)),t.push(h))}},t}},81:e=>{e.exports=function(e){return e[1]}},379:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var s={},o=[],a=0;a<e.length;a++){var c=e[a],u=r.base?c[0]+r.base:c[0],h=s[u]||0,l="".concat(u," ").concat(h);s[u]=h+1;var d=n(l),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)t[d].references++,t[d].updater(f);else{var p=i(f,r);r.byIndex=a,t.splice(a,0,{identifier:l,updater:p,references:1})}o.push(l)}return o}function i(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,i){var s=r(e=e||[],i=i||{});return function(e){e=e||[];for(var o=0;o<s.length;o++){var a=n(s[o]);t[a].references--}for(var c=r(e,i),u=0;u<s.length;u++){var h=n(s[u]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}s=c}}},569:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},216:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},565:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},795:e=>{e.exports=function(e){var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var s=n.sourceMap;s&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},589:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={id:r,exports:{}};return e[r](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e})(),n.nc=void 0,(()=>{const e=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},t={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,h=(3&i)<<4|o>>4;let l=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(l=64)),r.push(n[u],n[h],n[l],n[d])}return r.join("")},encodeString(t,n){return this.HAS_NATIVE_SUPPORT&&!n?btoa(t):this.encodeByteArray(e(t),n)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw Error();const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},r=function(n){return function(n){const r=e(n);return t.encodeByteArray(r,!0)}(n).replace(/\./g,"")},i=function(e){try{return t.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function s(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function o(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function a(){return"object"==typeof indexedDB}function c(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}const u=()=>{try{return function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__||(()=>{if("undefined"==typeof process||void 0===process.env)return;const e=process.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}const t=e&&i(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>{var t,n;return null===(n=null===(t=u())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},l=e=>{var t;return null===(t=u())||void 0===t?void 0:t[`_${e}`]};class d{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}class f extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,f.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,p.prototype.create)}}class p{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(g,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new f(r,o,n)}}const g=/\{\$([^}]+)}/g;function m(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(y(n)&&y(s)){if(!m(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function y(e){return null!==e&&"object"==typeof e}function v(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function w(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function b(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class I{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const t of["next","error","complete"])if(t in e&&"function"==typeof e[t])return!0;return!1}(e)?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=T),void 0===r.error&&(r.error=T),void 0===r.complete&&(r.complete=T);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function T(){}function E(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function _(e){return e&&e._delegate?e._delegate:e}class S{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const C="[DEFAULT]";class k{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new d;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:C})}catch(e){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e="[DEFAULT]"){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e="[DEFAULT]"){return this.instances.has(e)}getOptions(e="[DEFAULT]"){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[e,t]of this.instancesDeferred.entries())n===this.normalizeInstanceIdentifier(e)&&t.resolve(r);return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===C?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}var r;return n||null}normalizeInstanceIdentifier(e="[DEFAULT]"){return this.component?this.component.multipleInstances?e:C:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class A{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new k(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const N=[];var D,R;(R=D||(D={}))[R.DEBUG=0]="DEBUG",R[R.VERBOSE=1]="VERBOSE",R[R.INFO=2]="INFO",R[R.WARN=3]="WARN",R[R.ERROR=4]="ERROR",R[R.SILENT=5]="SILENT";const x={debug:D.DEBUG,verbose:D.VERBOSE,info:D.INFO,warn:D.WARN,error:D.ERROR,silent:D.SILENT},O=D.INFO,L={[D.DEBUG]:"log",[D.VERBOSE]:"log",[D.INFO]:"info",[D.WARN]:"warn",[D.ERROR]:"error"},P=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=L[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class M{constructor(e){this.name=e,this._logLevel=O,this._logHandler=P,this._userLogHandler=null,N.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in D))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?x[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,D.DEBUG,...e),this._logHandler(this,D.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,D.VERBOSE,...e),this._logHandler(this,D.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,D.INFO,...e),this._logHandler(this,D.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,D.WARN,...e),this._logHandler(this,D.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,D.ERROR,...e),this._logHandler(this,D.ERROR,...e)}}let U,F;const V=new WeakMap,j=new WeakMap,B=new WeakMap,q=new WeakMap,z=new WeakMap;let $={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return j.get(e);if("objectStoreNames"===t)return e.objectStoreNames||B.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return H(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function K(e){return"function"==typeof e?(t=e)!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(F||(F=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(G(this),e),H(V.get(this))}:function(...e){return H(t.apply(G(this),e))}:function(e,...n){const r=t.call(G(this),e,...n);return B.set(r,e.sort?e.sort():[e]),H(r)}:(e instanceof IDBTransaction&&function(e){if(j.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));j.set(e,t)}(e),n=e,(U||(U=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>n instanceof e))?new Proxy(e,$):e);var t,n}function H(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(H(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&V.set(t,e)})).catch((()=>{})),z.set(t,e),t}(e);if(q.has(e))return q.get(e);const t=K(e);return t!==e&&(q.set(e,t),z.set(t,e)),t}const G=e=>z.get(e);function W(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=H(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(H(o.result),e.oldVersion,e.newVersion,H(o.transaction))})),n&&o.addEventListener("blocked",(()=>n())),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(()=>i()))})).catch((()=>{})),a}const Q=["get","getKey","getAll","getAllKeys","count"],X=["put","add","delete","clear"],J=new Map;function Y(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(J.get(t))return J.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=X.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!Q.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return J.set(t,s),s}var Z;Z=$,$={...Z,get:(e,t,n)=>Y(e,t)||Z.get(e,t,n),has:(e,t)=>!!Y(e,t)||Z.has(e,t)};class ee{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const te="@firebase/app",ne="0.8.4",re=new M("@firebase/app"),ie="[DEFAULT]",se={[te]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},oe=new Map,ae=new Map;function ce(e,t){try{e.container.addComponent(t)}catch(n){re.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function ue(e){const t=e.name;if(ae.has(t))return re.debug(`There were multiple attempts to register component ${t}.`),!1;ae.set(t,e);for(const t of oe.values())ce(t,e);return!0}function he(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}const le=new p("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});class de{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new S("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw le.create("app-deleted",{appName:this._name})}}const fe="9.14.0";function pe(e,t={}){let n=e;"object"!=typeof t&&(t={name:t});const r=Object.assign({name:ie,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw le.create("bad-app-name",{appName:String(i)});if(n||(n=(()=>{var e;return null===(e=u())||void 0===e?void 0:e.config})()),!n)throw le.create("no-options");const s=oe.get(i);if(s){if(m(n,s.options)&&m(r,s.config))return s;throw le.create("duplicate-app",{appName:i})}const o=new A(i);for(const e of ae.values())o.addComponent(e);const a=new de(n,r,o);return oe.set(i,a),a}function ge(e="[DEFAULT]"){const t=oe.get(e);if(!t&&e===ie)return pe();if(!t)throw le.create("no-app",{appName:e});return t}function me(e,t,n){var r;let i=null!==(r=se[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void re.warn(e.join(" "))}ue(new S(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const ye="firebase-heartbeat-store";let ve=null;function we(){return ve||(ve=W("firebase-heartbeat-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore(ye)}}).catch((e=>{throw le.create("idb-open",{originalErrorMessage:e.message})}))),ve}async function be(e,t){var n;try{const n=(await we()).transaction(ye,"readwrite"),r=n.objectStore(ye);return await r.put(t,Ie(e)),n.done}catch(e){if(e instanceof f)re.warn(e.message);else{const t=le.create("idb-set",{originalErrorMessage:null===(n=e)||void 0===n?void 0:n.message});re.warn(t.message)}}}function Ie(e){return`${e.name}!${e.options.appId}`}class Te{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _e(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Ee();if(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate!==t&&!this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";const e=Ee(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Se(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Se(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=r(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}}function Ee(){return(new Date).toISOString().substring(0,10)}class _e{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!a()&&c().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){var t;try{return(await we()).transaction(ye).objectStore(ye).get(Ie(e))}catch(e){if(e instanceof f)re.warn(e.message);else{const n=le.create("idb-get",{originalErrorMessage:null===(t=e)||void 0===t?void 0:t.message});re.warn(n.message)}}}(this.app);return e||{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return be(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return be(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Se(e){return r(JSON.stringify({version:2,heartbeats:e})).length}ue(new S("platform-logger",(e=>new ee(e)),"PRIVATE")),ue(new S("heartbeat",(e=>new Te(e)),"PRIVATE")),me(te,ne,""),me(te,ne,"esm2017"),me("fire-js",""),me("firebase","9.14.0","app");const Ce="@firebase/installations",ke="0.5.16",Ae="w:0.5.16",Ne=new p("installations","Installations",{"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."});function De(e){return e instanceof f&&e.code.includes("request-failed")}function Re({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function xe(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function Oe(e,t){const n=(await t.json()).error;return Ne.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function Le({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}async function Pe(e){const t=await e();return t.status>=500&&t.status<600?e():t}function Me(e){return new Promise((t=>{setTimeout(t,e)}))}const Ue=/^[cdef][\w-]{21}$/;function Fe(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return Ue.test(t)?t:""}catch(e){return""}}function Ve(e){return`${e.appName}!${e.appId}`}const je=new Map;function Be(e,t){const n=Ve(e);qe(n,t),function(e,t){const n=(!ze&&"BroadcastChannel"in self&&(ze=new BroadcastChannel("[Firebase] FID Change"),ze.onmessage=e=>{qe(e.data.key,e.data.fid)}),ze);n&&n.postMessage({key:e,fid:t}),0===je.size&&ze&&(ze.close(),ze=null)}(n,t)}function qe(e,t){const n=je.get(e);if(n)for(const e of n)e(t)}let ze=null;const $e="firebase-installations-store";let Ke=null;function He(){return Ke||(Ke=W("firebase-installations-database",1,{upgrade:(e,t)=>{0===t&&e.createObjectStore($e)}})),Ke}async function Ge(e,t){const n=Ve(e),r=(await He()).transaction($e,"readwrite"),i=r.objectStore($e),s=await i.get(n);return await i.put(t,n),await r.done,s&&s.fid===t.fid||Be(e,t.fid),t}async function We(e){const t=Ve(e),n=(await He()).transaction($e,"readwrite");await n.objectStore($e).delete(t),await n.done}async function Qe(e,t){const n=Ve(e),r=(await He()).transaction($e,"readwrite"),i=r.objectStore($e),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.done,!o||s&&s.fid===o.fid||Be(e,o.fid),o}async function Xe(e){let t;const n=await Qe(e.appConfig,(n=>{const r=function(e){return Ze(e||{fid:Fe(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(Ne.create("app-offline"))};const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function({appConfig:e,heartbeatServiceProvider:t},{fid:n}){const r=Re(e),i=Le(e),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={fid:n,authVersion:"FIS_v2",appId:e.appId,sdkVersion:Ae},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Pe((()=>fetch(r,a)));if(c.ok){const e=await c.json();return{fid:e.fid||n,registrationStatus:2,refreshToken:e.refreshToken,authToken:xe(e.authToken)}}throw await Oe("Create Installation",c)}(e,t);return Ge(e.appConfig,n)}catch(n){throw De(n)&&409===n.customData.serverCode?await We(e.appConfig):await Ge(e.appConfig,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:Je(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function Je(e){let t=await Ye(e.appConfig);for(;1===t.registrationStatus;)await Me(100),t=await Ye(e.appConfig);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await Xe(e);return n||t}return t}function Ye(e){return Qe(e,(e=>{if(!e)throw Ne.create("installation-not-found");return Ze(e)}))}function Ze(e){return 1===(t=e).registrationStatus&&t.registrationTime+1e4<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function et({appConfig:e,heartbeatServiceProvider:t},n){const r=function(e,{fid:t}){return`${Re(e)}/${t}/authTokens:generate`}(e,n),i=function(e,{refreshToken:t}){const n=Le(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}(e,n),s=t.getImmediate({optional:!0});if(s){const e=await s.getHeartbeatsHeader();e&&i.append("x-firebase-client",e)}const o={installation:{sdkVersion:Ae,appId:e.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await Pe((()=>fetch(r,a)));if(c.ok)return xe(await c.json());throw await Oe("Generate Auth Token",c)}async function tt(e,t=!1){let n;const r=await Qe(e.appConfig,(r=>{if(!rt(r))throw Ne.create("not-registered");const i=r.authToken;if(!t&&(2===(s=i).requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+36e5}(s)))return r;var s;if(1===i.requestStatus)return n=async function(e,t){let n=await nt(e.appConfig);for(;1===n.authToken.requestStatus;)await Me(100),n=await nt(e.appConfig);const r=n.authToken;return 0===r.requestStatus?tt(e,t):r}(e,t),r;{if(!navigator.onLine)throw Ne.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await et(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await Ge(e.appConfig,r),n}catch(n){if(!De(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await Ge(e.appConfig,n)}else await We(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function nt(e){return Qe(e,(e=>{if(!rt(e))throw Ne.create("not-registered");return 1===(t=e.authToken).requestStatus&&t.requestTime+1e4<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var t}))}function rt(e){return void 0!==e&&2===e.registrationStatus}function it(e){return Ne.create("missing-app-config-values",{valueName:e})}const st="installations";ue(new S(st,(e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw it("App Configuration");if(!e.name)throw it("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw it(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,heartbeatServiceProvider:he(t,"heartbeat"),_delete:()=>Promise.resolve()}}),"PUBLIC")),ue(new S("installations-internal",(e=>{const t=he(e.getProvider("app").getImmediate(),st).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await Xe(t);return r?r.catch(console.error):tt(t).catch(console.error),n.fid}(t),getToken:e=>async function(e,t=!1){const n=e;return await async function(e){const{registrationPromise:t}=await Xe(e);t&&await t}(n),(await tt(n,t)).token}(t,e)}}),"PRIVATE")),me(Ce,ke),me(Ce,ke,"esm2017");const ot="analytics",at="https://www.googletagmanager.com/gtag/js",ct=new M("@firebase/analytics");function ut(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}const ht=new p("analytics","Analytics",{"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'}),lt=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function dt(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function ft(e,t=lt,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw ht.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw ht.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new gt;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),pt({appId:r,apiKey:i,measurementId:s},o,a,t)}async function pt(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=lt){var s,o;const{appId:a,measurementId:c}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(ht.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(c)return ct.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null===(s=e)||void 0===s?void 0:s.message}]`),{appId:a,measurementId:c};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:dt(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw ht.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(a),t}catch(t){const s=t;if(!function(e){if(!(e instanceof f&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(s)){if(i.deleteThrottleMetadata(a),c)return ct.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${c} provided in the "measurementId" field in the local Firebase config. [${null==s?void 0:s.message}]`),{appId:a,measurementId:c};throw t}const u=503===Number(null===(o=null==s?void 0:s.customData)||void 0===o?void 0:o.httpStatus)?E(n,i.intervalMillis,30):E(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+u,backoffCount:n+1};return i.setThrottleMetadata(a,h),ct.debug(`Calling attemptFetch again in ${u} millis`),pt(e,h,r,i)}}class gt{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}let mt,yt;async function vt(e,t,n,r,i,s,o){var u;const h=ft(e);h.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ct.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>ct.error(e))),t.push(h);const l=async function(){var e;if(!a())return ct.warn(ht.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await c()}catch(t){return ct.warn(ht.create("indexeddb-unavailable",{errorInfo:null===(e=t)||void 0===e?void 0:e.toString()}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[d,f]=await Promise.all([h,l]);(function(e){const t=window.document.getElementsByTagName("script");for(const n of Object.values(t))if(n.src&&n.src.includes(at)&&n.src.includes(e))return n;return null})(s)||function(e,t){const n=document.createElement("script");n.src=`${at}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(s,d.measurementId),yt&&(i("consent","default",yt),yt=void 0),i("js",new Date);const p=null!==(u=null==o?void 0:o.config)&&void 0!==u?u:{};return p.origin="firebase",p.update=!0,null!=f&&(p.firebase_id=f),i("config",d.measurementId,p),mt&&(i("set",mt),mt=void 0),d.measurementId}class wt{constructor(e){this.app=e}_delete(){return delete bt[this.app.options.appId],Promise.resolve()}}let bt={},It=[];const Tt={};let Et,_t,St="dataLayer",Ct=!1;function kt(e,t,n){!function(){const e=[];if(o()&&e.push("This is a browser extension environment."),"undefined"!=typeof navigator&&navigator.cookieEnabled||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=ht.create("invalid-analytics-context",{errorInfo:t});ct.warn(n.message)}}();const r=e.options.appId;if(!r)throw ht.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ht.create("no-api-key");ct.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=bt[r])throw ht.create("already-exists",{id:r});if(!Ct){!function(e){let t=[];Array.isArray(window.dataLayer)?t=window.dataLayer:window.dataLayer=t}();const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window.dataLayer.push(arguments)};return window.gtag&&"function"==typeof window.gtag&&(s=window.gtag),window.gtag=function(e,t,n,r){return async function(i,s,o){try{"event"===i?await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await ut(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){ct.error(e)}}(e,t,n,s,o):"config"===i?await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await ut(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){ct.error(e)}e("config",i,s)}(e,t,n,r,s,o):"consent"===i?e("consent","update",o):e("set",s)}catch(e){ct.error(e)}}}(s,e,t,n),{gtagCore:s,wrappedGtag:window.gtag}}(bt,It,Tt);_t=e,Et=t,Ct=!0}return bt[r]=vt(e,It,Tt,t,Et,St,n),new wt(e)}const At="@firebase/analytics",Nt="0.8.4";function Dt(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}ue(new S(ot,((e,{options:t})=>kt(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),ue(new S("analytics-internal",(function(e){try{const t=e.getProvider(ot).getImmediate();return{logEvent:(e,n,r)=>function(e,t,n,r){e=_(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(_t,bt[e.app.options.appId],t,n,r).catch((e=>ct.error(e)))}(t,e,n,r)}}catch(e){throw ht.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),me(At,Nt),me(At,Nt,"esm2017"),Object.create,Object.create;const Rt=function(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},xt=new p("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Ot=new M("@firebase/auth");function Lt(e,...t){Ot.logLevel<=D.ERROR&&Ot.error(`Auth (9.14.0): ${e}`,...t)}function Pt(e,...t){throw Ft(e,...t)}function Mt(e,...t){return Ft(e,...t)}function Ut(e,t,n){const r=Object.assign(Object.assign({},Rt()),{[t]:n});return new p("auth","Firebase",r).create(t,{appName:e.name})}function Ft(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return xt.create(e,...t)}function Vt(e,t,...n){if(!e)throw Ft(t,...n)}function jt(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Lt(t),new Error(t)}function Bt(e,t){e||jt(t)}const qt=new Map;function zt(e){Bt(e instanceof Function,"Expected a class definition");let t=qt.get(e);return t?(Bt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,qt.set(e,t),t)}function $t(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Kt(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Ht{constructor(e,t){this.shortDelay=e,this.longDelay=t,Bt(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(s())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===Kt()||"https:"===Kt()||o()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Gt(e,t){Bt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Wt{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void jt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void jt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void jt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Qt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},Xt=new Ht(3e4,6e4);function Jt(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Yt(e,t,n,r,i={}){return Zt(e,i,(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=v(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode),Wt.fetch()(tn(e,e.config.apiHost,n,o),Object.assign({method:t,headers:a,referrerPolicy:"no-referrer"},i))}))}async function Zt(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Qt),t);try{const t=new nn(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw rn(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw rn(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw rn(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw rn(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Ut(e,a,o);Pt(e,a)}}catch(t){if(t instanceof f)throw t;Pt(e,"network-request-failed")}}async function en(e,t,n,r,i={}){const s=await Yt(e,t,n,r,i);return"mfaPendingCredential"in s&&Pt(e,"multi-factor-auth-required",{_serverResponse:s}),s}function tn(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Gt(e.config,i):`${e.config.apiScheme}://${i}`}class nn{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(Mt(this.auth,"network-request-failed"))),Xt.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function rn(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Mt(e,t,r);return i.customData._tokenResponse=n,i}function sn(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function on(e){return 1e3*Number(e)}function an(e){var t;const[n,r,s]=e.split(".");if(void 0===n||void 0===r||void 0===s)return Lt("JWT malformed, contained fewer than 3 sections"),null;try{const e=i(r);return e?JSON.parse(e):(Lt("Failed to decode base64 JWT payload"),null)}catch(e){return Lt("Caught error parsing JWT payload as JSON",null===(t=e)||void 0===t?void 0:t.toString()),null}}async function cn(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof f&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class un{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){var e;try{await this.user.getIdToken(!0)}catch(t){return void("auth/network-request-failed"===(null===(e=t)||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class hn{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=sn(this.lastLoginAt),this.creationTime=sn(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ln(e){var t;const n=e.auth,r=await e.getIdToken(),i=await cn(e,async function(e,t){return Yt(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));Vt(null==i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map((e=>{var{providerId:t}=e,n=Dt(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[],a=(c=e.providerData,u=o,[...c.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var c,u;const h=e.isAnonymous,l=!(e.email&&s.passwordHash||(null==a?void 0:a.length)),d=!!h&&l,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new hn(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}class dn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Vt(e.idToken,"internal-error"),Vt(void 0!==e.idToken,"internal-error"),Vt(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=an(e);return Vt(t,"internal-error"),Vt(void 0!==t.exp,"internal-error"),Vt(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return Vt(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Zt(e,{},(async()=>{const n=v({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=tn(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Wt.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new dn;return n&&(Vt("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Vt("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Vt("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new dn,this.toJSON())}_performRefresh(){return jt("not implemented")}}function fn(e,t){Vt("string"==typeof e||void 0===e,"internal-error",{appName:t})}class pn{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=Dt(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new un(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new hn(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await cn(this,this.stsTokenManager.getToken(this.auth,e));return Vt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=_(e),r=await n.getIdToken(t),i=an(r);Vt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"==typeof i.firebase?i.firebase:void 0,o=null==s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:sn(on(i.auth_time)),issuedAtTime:sn(on(i.iat)),expirationTime:sn(on(i.exp)),signInProvider:o||null,signInSecondFactor:(null==s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=_(e);await ln(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Vt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new pn(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){Vt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ln(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await cn(this,async function(e,t){return Yt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const h=null!==(n=t.displayName)&&void 0!==n?n:void 0,l=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:b,providerData:I,stsTokenManager:T}=t;Vt(v&&T,e,"internal-error");const E=dn.fromJSON(this.name,T);Vt("string"==typeof v,e,"internal-error"),fn(h,e.name),fn(l,e.name),Vt("boolean"==typeof w,e,"internal-error"),Vt("boolean"==typeof b,e,"internal-error"),fn(d,e.name),fn(f,e.name),fn(p,e.name),fn(g,e.name),fn(m,e.name),fn(y,e.name);const _=new pn({uid:v,auth:e,email:l,emailVerified:w,displayName:h,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:m,lastLoginAt:y});return I&&Array.isArray(I)&&(_.providerData=I.map((e=>Object.assign({},e)))),g&&(_._redirectEventId=g),_}static async _fromIdTokenResponse(e,t,n=!1){const r=new dn;r.updateFromServerResponse(t);const i=new pn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ln(i),i}}class gn{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}gn.type="NONE";const mn=gn;function yn(e,t,n){return`firebase:${e}:${t}:${n}`}class vn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=yn(this.userKey,r.apiKey,i),this.fullPersistenceKey=yn("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?pn._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new vn(zt(mn),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||zt(mn);const s=yn(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=pn._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new vn(i,e,n)):new vn(i,e,n)}}function wn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(En(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(bn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Sn(t))return"Blackberry";if(Cn(t))return"Webos";if(In(t))return"Safari";if((t.includes("chrome/")||Tn(t))&&!t.includes("edge/"))return"Chrome";if(_n(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function bn(e=s()){return/firefox\//i.test(e)}function In(e=s()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Tn(e=s()){return/crios\//i.test(e)}function En(e=s()){return/iemobile/i.test(e)}function _n(e=s()){return/android/i.test(e)}function Sn(e=s()){return/blackberry/i.test(e)}function Cn(e=s()){return/webos/i.test(e)}function kn(e=s()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function An(e=s()){return kn(e)||_n(e)||Cn(e)||Sn(e)||/windows phone/i.test(e)||En(e)}function Nn(e,t=[]){let n;switch(e){case"Browser":n=wn(s());break;case"Worker":n=`${wn(s())}-${e}`;break;default:n=e}return`${n}/JsCore/9.14.0/${t.length?t.join(","):"FirebaseCore-web"}`}class Dn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(e){r(e)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){var t;if(this.auth.currentUser===e)return;const n=[];try{for(const t of this.queue)await t(e),t.onAbort&&n.push(t.onAbort)}catch(e){n.reverse();for(const e of n)try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(t=e)||void 0===t?void 0:t.message})}}}class Rn{constructor(e,t,n){this.app=e,this.heartbeatServiceProvider=t,this.config=n,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new On(this),this.idTokenSubscription=new On(this),this.beforeStateQueue=new Dn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=xt,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=n.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=zt(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await vn.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUser(e){var t;const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null==o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(e)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Vt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){var t;try{await ln(e)}catch(e){if("auth/network-request-failed"!==(null===(t=e)||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?_(e):null;return t&&Vt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Vt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(zt(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new p("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&zt(e)||this._popupRedirectResolver;Vt(t,this,"argument-error"),this.redirectPersistenceManager=await vn.create(this,[zt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return Vt(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Vt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nn(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());return n&&(t["X-Firebase-Client"]=n),t}}function xn(e){return _(e)}class On{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new I(e,void 0);return n.subscribe.bind(n)}((e=>this.observer=e))}get next(){return Vt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Ln(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Pn(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Mn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return jt("not implemented")}_getIdTokenResponse(e){return jt("not implemented")}_linkToIdToken(e,t){return jt("not implemented")}_getReauthenticationResolver(e){return jt("not implemented")}}class Un extends Mn{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Un(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Un(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return en(e,"POST","/v1/accounts:signInWithPassword",Jt(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return en(e,"POST","/v1/accounts:signInWithEmailLink",Jt(e,t))}(e,{email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return async function(e,t){return Yt(e,"POST","/v1/accounts:update",t)}(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return en(e,"POST","/v1/accounts:signInWithEmailLink",Jt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Pt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Fn(e,t){return en(e,"POST","/v1/accounts:signInWithIdp",Jt(e,t))}class Vn extends Mn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Vn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Pt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=Dt(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Vn(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Fn(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Fn(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fn(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=v(t)}return e}}const jn={USER_NOT_FOUND:"user-not-found"};class Bn extends Mn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Bn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Bn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return en(e,"POST","/v1/accounts:signInWithPhoneNumber",Jt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await en(e,"POST","/v1/accounts:signInWithPhoneNumber",Jt(e,t));if(n.temporaryProof)throw rn(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return en(e,"POST","/v1/accounts:signInWithPhoneNumber",Jt(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),jn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Bn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class qn{constructor(e){var t,n,r,i,s,o;const a=w(b(e)),c=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Vt(c&&u&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=w(b(e)).link,n=t?w(b(t)).deep_link_id:null,r=w(b(e)).deep_link_id;return(r?w(b(r)).link:null)||r||n||t||e}(e);try{return new qn(t)}catch(e){return null}}}class zn{constructor(){this.providerId=zn.PROVIDER_ID}static credential(e,t){return Un._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=qn.parseLink(t);return Vt(n,"argument-error"),Un._fromEmailAndCode(e,n.code,n.tenantId)}}zn.PROVIDER_ID="password",zn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",zn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class $n{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Kn extends $n{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Hn extends Kn{constructor(){super("facebook.com")}static credential(e){return Vn._fromParams({providerId:Hn.PROVIDER_ID,signInMethod:Hn.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Hn.credentialFromTaggedObject(e)}static credentialFromError(e){return Hn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Hn.credential(e.oauthAccessToken)}catch(e){return null}}}Hn.FACEBOOK_SIGN_IN_METHOD="facebook.com",Hn.PROVIDER_ID="facebook.com";class Gn extends Kn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Vn._fromParams({providerId:Gn.PROVIDER_ID,signInMethod:Gn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Gn.credentialFromTaggedObject(e)}static credentialFromError(e){return Gn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Gn.credential(t,n)}catch(e){return null}}}Gn.GOOGLE_SIGN_IN_METHOD="google.com",Gn.PROVIDER_ID="google.com";class Wn extends Kn{constructor(){super("github.com")}static credential(e){return Vn._fromParams({providerId:Wn.PROVIDER_ID,signInMethod:Wn.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wn.credentialFromTaggedObject(e)}static credentialFromError(e){return Wn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Wn.credential(e.oauthAccessToken)}catch(e){return null}}}Wn.GITHUB_SIGN_IN_METHOD="github.com",Wn.PROVIDER_ID="github.com";class Qn extends Kn{constructor(){super("twitter.com")}static credential(e,t){return Vn._fromParams({providerId:Qn.PROVIDER_ID,signInMethod:Qn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Qn.credentialFromTaggedObject(e)}static credentialFromError(e){return Qn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Qn.credential(t,n)}catch(e){return null}}}Qn.TWITTER_SIGN_IN_METHOD="twitter.com",Qn.PROVIDER_ID="twitter.com";class Xn{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await pn._fromIdTokenResponse(e,n,r),s=Jn(n);return new Xn({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Jn(n);return new Xn({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Jn(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class Yn extends f{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Yn.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Yn(e,t,n,r)}}function Zn(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Yn._fromErrorAndOperation(e,n,t,r);throw n}))}new WeakMap;const er="__sak";class tr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(er,"1"),this.storage.removeItem(er),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class nr extends tr{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=s();return In(e)||kn(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=An(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);!function(){const e=s();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()||10!==document.documentMode||i===e.newValue||e.newValue===e.oldValue?r():setTimeout(r,10)}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}nr.type="LOCAL";const rr=nr;class ir extends tr{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ir.type="SESSION";const sr=ir;class or{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new or(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function ar(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}or.receivers=[];class cr{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=ar("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function ur(){return window}function hr(){return void 0!==ur().WorkerGlobalScope&&"function"==typeof ur().importScripts}const lr="firebaseLocalStorageDb",dr="firebaseLocalStorage",fr="fbase_key";class pr{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function gr(e,t){return e.transaction([dr],t?"readwrite":"readonly").objectStore(dr)}function mr(){const e=indexedDB.open(lr,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(dr,{keyPath:fr})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(dr)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(lr);return new pr(e).toPromise()}(),t(await mr()))}))}))}async function yr(e,t,n){const r=gr(e,!0).put({[fr]:t,value:n});return new pr(r).toPromise()}function vr(e,t){const n=gr(e,!0).delete(t);return new pr(n).toPromise()}class wr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await mr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return hr()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=or._getInstance(hr()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new cr(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await mr();return await yr(e,er,"1"),await vr(e,er),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>yr(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=gr(e,!1).get(t),r=await new pr(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>vr(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=gr(e,!1).getAll();return new pr(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}wr.type="LOCAL";const br=wr;function Ir(e){return`__${e}${Math.floor(1e6*Math.random())}`}Ir("rcb"),new Ht(3e4,6e4);class Tr{constructor(e){this.providerId=Tr.PROVIDER_ID,this.auth=xn(e)}verifyPhoneNumber(e,t){return async function(e,t,n){var r;const i=await n.verify();try{let s;if(Vt("string"==typeof i,e,"argument-error"),Vt("recaptcha"===n.type,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Vt("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Yt(e,"POST","/v2/accounts/mfaEnrollment:start",Jt(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Vt("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Vt(n,e,"missing-multi-factor-info");const o=await function(e,t){return Yt(e,"POST","/v2/accounts/mfaSignIn:start",Jt(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Yt(e,"POST","/v1/accounts:sendVerificationCode",Jt(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}(this.auth,e,_(t))}static credential(e,t){return Bn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Tr.credentialFromTaggedObject(t)}static credentialFromError(e){return Tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Bn._fromTokenResponse(t,n):null}}function Er(e,t){return t?zt(t):(Vt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Tr.PROVIDER_ID="phone",Tr.PHONE_SIGN_IN_METHOD="phone";class _r extends Mn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Sr(e){return async function(e,t,n=!1){const r="signIn",i=await Zn(e,r,t),s=await Xn._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}(e.auth,new _r(e),e.bypassAuthState)}function Cr(e){const{auth:t,user:n}=e;return Vt(n,t,"internal-error"),async function(e,t,n=!1){var r;const{auth:i}=e,s="reauthenticate";try{const r=await cn(e,Zn(i,s,t,e),n);Vt(r.idToken,i,"internal-error");const o=an(r.idToken);Vt(o,i,"internal-error");const{sub:a}=o;return Vt(e.uid===a,i,"user-mismatch"),Xn._forOperation(e,s,r)}catch(e){throw"auth/user-not-found"===(null===(r=e)||void 0===r?void 0:r.code)&&Pt(i,"user-mismatch"),e}}(n,new _r(e),e.bypassAuthState)}async function kr(e){const{auth:t,user:n}=e;return Vt(n,t,"internal-error"),async function(e,t,n=!1){const r=await cn(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Xn._forOperation(e,"link",r)}(n,new _r(e),e.bypassAuthState)}class Ar{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Sr;case"linkViaPopup":case"linkViaRedirect":return kr;case"reauthViaPopup":case"reauthViaRedirect":return Cr;default:Pt(this.auth,"internal-error")}}resolve(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Bt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Nr=new Ht(2e3,1e4);class Dr extends Ar{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Dr.currentPopupAction&&Dr.currentPopupAction.cancel(),Dr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Vt(e,this.auth,"internal-error"),e}async onExecution(){Bt(1===this.filter.length,"Popup operations only handle one event");const e=ar();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(Mt(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(Mt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dr.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(Mt(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,Nr.get())};e()}}Dr.currentPopupAction=null;const Rr=new Map;class xr extends Ar{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Rr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return yn("pendingRedirect",e.config.apiKey,e.name)}(t),r=function(e){return zt(e._redirectPersistence)}(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Rr.set(this.auth._key(),e)}return this.bypassAuthState||Rr.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Or(e,t){Rr.set(e._key(),t)}async function Lr(e,t,n=!1){const r=xn(e),i=Er(r,t),s=new xr(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Pr{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ur(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ur(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(Mt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Mr(e))}saveEventToCache(e){this.cachedEventUids.add(Mr(e)),this.lastProcessedEventTime=Date.now()}}function Mr(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ur({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}const Fr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Vr=/^https?/;function jr(e){const t=$t(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Vr.test(n))return!1;if(Fr.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Br=new Ht(3e4,6e4);function qr(){const e=ur().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let zr=null;function $r(e){return zr=zr||function(e){return new Promise(((t,n)=>{var r,i,s,o;function a(){qr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{qr(),n(Mt(e,"network-request-failed"))},timeout:Br.get()})}if(null===(i=null===(r=ur().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=ur().gapi)||void 0===s?void 0:s.load)){const t=Ir("iframefcb");return ur()[t]=()=>{gapi.load?a():n(Mt(e,"network-request-failed"))},(o=`https://apis.google.com/js/api.js?onload=${t}`,new Promise(((e,t)=>{const n=document.createElement("script");n.setAttribute("src",o),n.onload=e,n.onerror=e=>{const n=Mt("internal-error");n.customData=e,t(n)},n.type="text/javascript",n.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(n)}))).catch((e=>n(e)))}a()}})).catch((e=>{throw zr=null,e}))}(e),zr}const Kr=new Ht(5e3,15e3),Hr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Gr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Wr(e){const t=e.config;Vt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Gt(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:fe},i=Gr.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${v(r).slice(1)}`}const Qr={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Xr{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Jr(e,t,n,r,i,s){Vt(e.config.authDomain,e,"auth-domain-config-required"),Vt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:fe,eventId:i};if(t instanceof $n){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Kn){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const e of Object.keys(a))void 0===a[e]&&delete a[e];return`${function({config:e}){return e.emulator?Gt(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${v(a).slice(1)}`}const Yr="webStorageSupport",Zr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=sr,this._completeRedirectFn=Lr,this._overrideRedirectResult=Or}async _openPopup(e,t,n,r){var i;return Bt(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),function(e,t,n,r=500,i=600){const o=Math.max((window.screen.availHeight-i)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u=Object.assign(Object.assign({},Qr),{width:r.toString(),height:i.toString(),top:o,left:a}),h=s().toLowerCase();n&&(c=Tn(h)?"_blank":n),bn(h)&&(t=t||"http://localhost",u.scrollbars="yes");const l=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=s()){var t;return kn(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(h)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Xr(null);const d=window.open(t||"",c,l);Vt(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Xr(d)}(e,Jr(e,t,n,$t(),r),ar())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=Jr(e,t,n,$t(),r),ur().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Bt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await async function(e){const t=await $r(e),n=ur().gapi;return Vt(n,e,"internal-error"),t.open({where:document.body,url:Wr(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Hr,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=Mt(e,"network-request-failed"),s=ur().setTimeout((()=>{r(i)}),Kr.get());function o(){ur().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new Pr(e);return t.register("authEvent",(t=>(Vt(null==t?void 0:t.authEvent,e,"invalid-auth-event"),{status:n.onEvent(t.authEvent)?"ACK":"ERROR"})),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yr,{type:Yr},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),Pt(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Yt(e,"GET","/v1/projects",t)}(e);for(const e of t)try{if(jr(e))return}catch(e){}Pt(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return An()||In()||kn()}};var ei="@firebase/auth",ti="0.20.11";class ni{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Vt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ri=l("authIdTokenMaxAge")||300;let ii=null;var si;si="Browser",ue(new S("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),{apiKey:i,authDomain:s}=n.options;return((e,n)=>{Vt(i&&!i.includes(":"),"invalid-api-key",{appName:e.name}),Vt(!(null==s?void 0:s.includes(":")),"argument-error",{appName:e.name});const r={apiKey:i,authDomain:s,clientPlatform:si,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nn(si)},o=new Rn(e,n,r);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(zt);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(o,t),o})(n,r)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ue(new S("auth-internal",(e=>(e=>new ni(e))(xn(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),me(ei,ti,void 0),me(ei,ti,"esm2017");var oi,ai="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},ci={},ui=ui||{},hi=ai||self;function li(){}function di(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function fi(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var pi="closure_uid_"+(1e9*Math.random()>>>0),gi=0;function mi(e,t,n){return e.call.apply(e.bind,arguments)}function yi(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function vi(e,t,n){return(vi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?mi:yi).apply(null,arguments)}function wi(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function bi(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Wb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function Ii(){this.s=this.s,this.o=this.o}Ii.prototype.s=!1,Ii.prototype.na=function(){var e;!this.s&&(this.s=!0,this.M(),0)&&(e=this,Object.prototype.hasOwnProperty.call(e,pi)&&e[pi]||(e[pi]=++gi))},Ii.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const Ti=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1};function Ei(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function _i(e,t){for(let t=1;t<arguments.length;t++){const n=arguments[t];if(di(n)){const t=e.length||0,r=n.length||0;e.length=t+r;for(let i=0;i<r;i++)e[t+i]=n[i]}else e.push(n)}}function Si(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}Si.prototype.h=function(){this.defaultPrevented=!0};var Ci=function(){if(!hi.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{hi.addEventListener("test",li,t),hi.removeEventListener("test",li,t)}catch(e){}return e}();function ki(e){return/^[\s\xa0]*$/.test(e)}var Ai=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Ni(e,t){return e<t?-1:e>t?1:0}function Di(){var e=hi.navigator;return e&&(e=e.userAgent)?e:""}function Ri(e){return-1!=Di().indexOf(e)}function xi(e){return xi[" "](e),e}xi[" "]=li;var Oi,Li,Pi=Ri("Opera"),Mi=Ri("Trident")||Ri("MSIE"),Ui=Ri("Edge"),Fi=Ui||Mi,Vi=Ri("Gecko")&&!(-1!=Di().toLowerCase().indexOf("webkit")&&!Ri("Edge"))&&!(Ri("Trident")||Ri("MSIE"))&&!Ri("Edge"),ji=-1!=Di().toLowerCase().indexOf("webkit")&&!Ri("Edge");function Bi(){var e=hi.document;return e?e.documentMode:void 0}e:{var qi="",zi=(Li=Di(),Vi?/rv:([^\);]+)(\)|;)/.exec(Li):Ui?/Edge\/([\d\.]+)/.exec(Li):Mi?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Li):ji?/WebKit\/(\S+)/.exec(Li):Pi?/(?:Version)[ \/]?(\S+)/.exec(Li):void 0);if(zi&&(qi=zi?zi[1]:""),Mi){var $i=Bi();if(null!=$i&&$i>parseFloat(qi)){Oi=String($i);break e}}Oi=qi}var Ki,Hi={};function Gi(){return function(e){var t=Hi;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=function(){let e=0;const t=Ai(String(Oi)).split("."),n=Ai("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=Ni(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||Ni(0==i[2].length,0==s[2].length)||Ni(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e}()}()}hi.document&&Mi?Ki=Bi()||parseInt(Oi,10)||void 0:Ki=void 0;var Wi=Ki;function Qi(e,t){if(Si.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(Vi){e:{try{xi(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:Xi[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&Qi.X.h.call(this)}}bi(Qi,Si);var Xi={2:"touch",3:"pen",4:"mouse"};Qi.prototype.h=function(){Qi.X.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var Ji="closure_listenable_"+(1e6*Math.random()|0),Yi=0;function Zi(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++Yi,this.ba=this.ea=!1}function es(e){e.ba=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function ts(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function ns(e){const t={};for(const n in e)t[n]=e[n];return t}const rs="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function is(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<rs.length;t++)n=rs[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function ss(e){this.src=e,this.g={},this.h=0}function os(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Ti(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(es(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function as(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ba&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}ss.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=as(e,t,r,i);return-1<o?(t=e[o],n||(t.ea=!1)):((t=new Zi(t,this.src,s,!!r,i)).ea=n,e.push(t)),t};var cs="closure_lm_"+(1e6*Math.random()|0),us={};function hs(e,t,n,r,i){if(r&&r.once)return ds(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)hs(e,t[s],n,r,i);return null}return n=ws(n),e&&e[Ji]?e.N(t,n,fi(r)?!!r.capture:!!r,i):ls(e,t,n,!1,r,i)}function ls(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=fi(i)?!!i.capture:!!i,a=ys(e);if(a||(e[cs]=a=new ss(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){const e=ms;return function t(n){return e.call(t.src,t.listener,n)}}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Ci||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(gs(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ds(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ds(e,t[s],n,r,i);return null}return n=ws(n),e&&e[Ji]?e.O(t,n,fi(r)?!!r.capture:!!r,i):ls(e,t,n,!0,r,i)}function fs(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)fs(e,t[s],n,r,i);else r=fi(r)?!!r.capture:!!r,n=ws(n),e&&e[Ji]?(e=e.i,(t=String(t).toString())in e.g&&-1<(n=as(s=e.g[t],n,r,i))&&(es(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--))):e&&(e=ys(e))&&(t=e.g[t.toString()],e=-1,t&&(e=as(t,n,r,i)),(n=-1<e?t[e]:null)&&ps(n))}function ps(e){if("number"!=typeof e&&e&&!e.ba){var t=e.src;if(t&&t[Ji])os(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(gs(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=ys(t))?(os(n,e),0==n.h&&(n.src=null,t[cs]=null)):es(e)}}}function gs(e){return e in us?us[e]:us[e]="on"+e}function ms(e,t){if(e.ba)e=!0;else{t=new Qi(t,this);var n=e.listener,r=e.ha||e.src;e.ea&&ps(e),e=n.call(r,t)}return e}function ys(e){return(e=e[cs])instanceof ss?e:null}var vs="__closure_events_fn_"+(1e9*Math.random()>>>0);function ws(e){return"function"==typeof e?e:(e[vs]||(e[vs]=function(t){return e.handleEvent(t)}),e[vs])}function bs(){Ii.call(this),this.i=new ss(this),this.P=this,this.I=null}function Is(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new Si(t,e);else if(t instanceof Si)t.target=t.target||e;else{var i=t;is(t=new Si(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Ts(o,r,!0,t)&&i}if(i=Ts(o=t.g=e,r,!0,t)&&i,i=Ts(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Ts(o=t.g=n[s],r,!1,t)&&i}function Ts(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ba&&o.capture==n){var a=o.listener,c=o.ha||o.src;o.ea&&os(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}bi(bs,Ii),bs.prototype[Ji]=!0,bs.prototype.removeEventListener=function(e,t,n,r){fs(this,e,t,n,r)},bs.prototype.M=function(){if(bs.X.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)es(n[r]);delete t.g[e],t.h--}}this.I=null},bs.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},bs.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Es=hi.JSON.stringify;function _s(){var e=Rs;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Ss,Cs=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new ks),(e=>e.reset()));class ks{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function As(e){hi.setTimeout((()=>{throw e}),0)}function Ns(e,t){Ss||function(){var e=hi.Promise.resolve(void 0);Ss=function(){e.then(xs)}}(),Ds||(Ss(),Ds=!0),Rs.add(e,t)}var Ds=!1,Rs=new class{constructor(){this.h=this.g=null}add(e,t){const n=Cs.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function xs(){for(var e;e=_s();){try{e.h.call(e.g)}catch(e){As(e)}var t=Cs;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ds=!1}function Os(e,t){bs.call(this),this.h=e||1,this.g=t||hi,this.j=vi(this.lb,this),this.l=Date.now()}function Ls(e){e.ca=!1,e.R&&(e.g.clearTimeout(e.R),e.R=null)}function Ps(e,t,n){if("function"==typeof e)n&&(e=vi(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=vi(e.handleEvent,e)}return 2147483647<Number(t)?-1:hi.setTimeout(e,t||0)}function Ms(e){e.g=Ps((()=>{e.g=null,e.i&&(e.i=!1,Ms(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}bi(Os,bs),(oi=Os.prototype).ca=!1,oi.R=null,oi.lb=function(){if(this.ca){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.R=this.g.setTimeout(this.j,this.h-e):(this.R&&(this.g.clearTimeout(this.R),this.R=null),Is(this,"tick"),this.ca&&(Ls(this),this.start()))}},oi.start=function(){this.ca=!0,this.R||(this.R=this.g.setTimeout(this.j,this.h),this.l=Date.now())},oi.M=function(){Os.X.M.call(this),Ls(this),delete this.g};class Us extends Ii{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Ms(this)}M(){super.M(),this.g&&(hi.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Fs(e){Ii.call(this),this.h=e,this.g={}}bi(Fs,Ii);var Vs=[];function js(e,t,n,r){Array.isArray(n)||(n&&(Vs[0]=n.toString()),n=Vs);for(var i=0;i<n.length;i++){var s=hs(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function Bs(e){ts(e.g,(function(e,t){this.g.hasOwnProperty(t)&&ps(e)}),e),e.g={}}function qs(){this.g=!0}function zs(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Es(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}Fs.prototype.M=function(){Fs.X.M.call(this),Bs(this)},Fs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},qs.prototype.Aa=function(){this.g=!1},qs.prototype.info=function(){};var $s={},Ks=null;function Hs(){return Ks=Ks||new bs}function Gs(e){Si.call(this,$s.Pa,e)}function Ws(e){const t=Hs();Is(t,new Gs(t))}function Qs(e,t){Si.call(this,$s.STAT_EVENT,e),this.stat=t}function Xs(e){const t=Hs();Is(t,new Qs(t,e))}function Js(e,t){Si.call(this,$s.Qa,e),this.size=t}function Ys(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return hi.setTimeout((function(){e()}),t)}$s.Pa="serverreachability",bi(Gs,Si),$s.STAT_EVENT="statevent",bi(Qs,Si),$s.Qa="timingevent",bi(Js,Si);var Zs={NO_ERROR:0,mb:1,zb:2,yb:3,tb:4,xb:5,Ab:6,Ma:7,TIMEOUT:8,Db:9},eo={rb:"complete",Nb:"success",Na:"error",Ma:"abort",Fb:"ready",Gb:"readystatechange",TIMEOUT:"timeout",Bb:"incrementaldata",Eb:"progress",ub:"downloadprogress",Vb:"uploadprogress"};function to(){}function no(e){return e.h||(e.h=e.i())}function ro(){}to.prototype.h=null;var io,so={OPEN:"a",qb:"b",Na:"c",Cb:"d"};function oo(){Si.call(this,"d")}function ao(){Si.call(this,"c")}function co(){}function uo(e,t,n,r){this.l=e,this.j=t,this.m=n,this.U=r||1,this.S=new Fs(this),this.O=lo,e=Fi?125:void 0,this.T=new Os(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.V=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.Y=-1,this.I=!1,this.N=0,this.L=null,this.$=this.J=this.Z=this.P=!1,this.h=new ho}function ho(){this.i=null,this.g="",this.h=!1}bi(oo,Si),bi(ao,Si),bi(co,to),co.prototype.g=function(){return new XMLHttpRequest},co.prototype.i=function(){return{}},io=new co;var lo=45e3,fo={},po={};function go(e,t,n){e.K=1,e.v=Lo(No(t)),e.s=n,e.P=!0,mo(e,null)}function mo(e,t){e.F=Date.now(),bo(e),e.A=No(e.v);var n=e.A,r=e.U;Array.isArray(r)||(r=[String(r)]),Go(n.i,"t",r),e.C=0,n=e.l.H,e.h=new ho,e.g=Ha(e.l,n?t:null,!e.s),0<e.N&&(e.L=new Us(vi(e.La,e,e.g),e.N)),js(e.S,e.g,"readystatechange",e.ib),t=e.H?ns(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.da(e.A,e.u,e.s,t)):(e.u="GET",e.g.da(e.A,e.u,null,t)),Ws(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var h=u[0];u=u[1];var l=h.split("_");o=2<=l.length&&"type"==l[1]?o+(h+"=")+u+"&":o+(h+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.U,e.s)}function yo(e){return!!e.g&&"GET"==e.u&&2!=e.K&&e.l.Da}function vo(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=wo(e,n),r==po){4==t&&(e.o=4,Xs(14),i=!1),zs(e.j,e.m,null,"[Incomplete Response]");break}if(r==fo){e.o=4,Xs(15),zs(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}zs(e.j,e.m,r,null),So(e,r)}yo(e)&&r!=po&&r!=fo&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,Xs(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.$&&(e.$=!0,(t=e.l).g==e&&t.$&&!t.K&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Fa(t),t.K=!0,Xs(11))):(zs(e.j,e.m,n,"[Invalid Chunked Response]"),_o(e),Eo(e))}function wo(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?po:(n=Number(t.substring(n,r)),isNaN(n)?fo:(r+=1)+n>t.length?po:(t=t.substr(r,n),e.C=r+n,t))}function bo(e){e.V=Date.now()+e.O,Io(e,e.O)}function Io(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=Ys(vi(e.gb,e),t)}function To(e){e.B&&(hi.clearTimeout(e.B),e.B=null)}function Eo(e){0==e.l.G||e.I||Ba(e.l,e)}function _o(e){To(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Ls(e.T),Bs(e.S),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function So(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||Zo(n.h,e)))if(!e.J&&Zo(n.h,e)&&3==n.G){try{var r=n.Fa.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;ja(n),Da(n)}Ua(n),Xs(18)}}else n.Ba=i[1],0<n.Ba-n.T&&37500>i[2]&&n.L&&0==n.A&&!n.v&&(n.v=Ys(vi(n.cb,n),6e3));if(1>=Yo(n.h)&&n.ja){try{n.ja()}catch(e){}n.ja=void 0}}else za(n,11)}else if((e.J||n.g==e)&&ja(n),!ki(t))for(i=n.Fa.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.I=u[1],n.ka=u[2];const t=u[3];null!=t&&(n.ma=t,n.j.info("VER="+n.ma));const i=u[4];null!=i&&(n.Ca=i,n.j.info("SVER="+n.Ca));const h=u[5];null!=h&&"number"==typeof h&&0<h&&(r=1.5*h,n.J=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const l=e.g;if(l){const e=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ea(s,s.h),s.h=null))}if(r.D){const e=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.za=e,Oo(r.F,r.D,e))}}n.G=3,n.l&&n.l.xa(),n.$&&(n.P=Date.now()-e.F,n.j.info("Handshake RTT: "+n.P+"ms"));var o=e;if((r=n).sa=Ka(r,r.H?r.ka:null,r.V),o.J){ta(r.h,o);var a=o,c=r.J;c&&a.setTimeout(c),a.B&&(To(a),bo(a)),r.g=o}else Ma(r);0<n.i.length&&xa(n)}else"stop"!=u[0]&&"close"!=u[0]||za(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?za(n,7):Na(n):"noop"!=u[0]&&n.l&&n.l.wa(u),n.A=0)}Ws()}catch(e){}}function Co(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(di(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.oa&&"function"==typeof e.oa)return e.oa();if(!e.W||"function"!=typeof e.W){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(di(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.W&&"function"==typeof e.W)return e.W();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(di(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(oi=uo.prototype).setTimeout=function(e){this.O=e},oi.ib=function(e){e=e.target;const t=this.L;t&&3==Ea(e)?t.l():this.La(e)},oi.La=function(e){try{if(e==this.g)e:{const h=Ea(this.g);var t=this.g.Ea();if(this.g.aa(),!(3>h)&&(3!=h||Fi||this.g&&(this.h.h||this.g.fa()||_a(this.g)))){this.I||4!=h||7==t||Ws(),To(this);var n=this.g.aa();this.Y=n;t:if(yo(this)){var r=_a(this.g);e="";var i=r.length,s=4==Ea(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){_o(this),Eo(this);var o="";break t}this.h.i=new hi.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.fa();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.U,h,n),this.i){if(this.Z&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!ki(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,Xs(12),_o(this),Eo(this);break e}zs(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,So(this,n)}this.P?(vo(this,h,o),Fi&&this.i&&3==h&&(js(this.S,this.T,"tick",this.hb),this.T.start())):(zs(this.j,this.m,o,null),So(this,o)),4==h&&_o(this),this.i&&!this.I&&(4==h?Ba(this.l,this):(this.i=!1,bo(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,Xs(12)):(this.o=0,Xs(13)),_o(this),Eo(this)}}}catch(e){}},oi.hb=function(){if(this.g){var e=Ea(this.g),t=this.g.fa();this.C<t.length&&(To(this),vo(this,e,t),this.i&&4!=e&&bo(this))}},oi.cancel=function(){this.I=!0,_o(this)},oi.gb=function(){this.B=null;const e=Date.now();0<=e-this.V?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(Ws(),Xs(17)),_o(this),this.o=2,Eo(this)):Io(this,this.V-e)};var ko=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ao(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof Ao){this.h=void 0!==t?t:e.h,Do(this,e.j),this.s=e.s,this.g=e.g,Ro(this,e.m),this.l=e.l,t=e.i;var n=new zo;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),xo(this,n),this.o=e.o}else e&&(n=String(e).match(ko))?(this.h=!!t,Do(this,n[1]||"",!0),this.s=Po(n[2]||""),this.g=Po(n[3]||"",!0),Ro(this,n[4]),this.l=Po(n[5]||"",!0),xo(this,n[6]||"",!0),this.o=Po(n[7]||"")):(this.h=!!t,this.i=new zo(null,this.h))}function No(e){return new Ao(e)}function Do(e,t,n){e.j=n?Po(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Ro(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function xo(e,t,n){t instanceof zo?(e.i=t,function(e,t){t&&!e.j&&($o(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Ko(this,t),Go(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=Mo(t,Bo)),e.i=new zo(t,e.h))}function Oo(e,t,n){e.i.set(t,n)}function Lo(e){return Oo(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Po(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Mo(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Uo),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Uo(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ao.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Mo(t,Fo,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Mo(t,Fo,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(Mo(n,"/"==n.charAt(0)?jo:Vo,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Mo(n,qo)),e.join("")};var Fo=/[#\/\?@]/g,Vo=/[#\?:]/g,jo=/[#\?]/g,Bo=/[#\?@]/g,qo=/#/g;function zo(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function $o(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ko(e,t){$o(e),t=Wo(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Ho(e,t){return $o(e),t=Wo(e,t),e.g.has(t)}function Go(e,t,n){Ko(e,t),0<n.length&&(e.i=null,e.g.set(Wo(e,t),Ei(n)),e.h+=n.length)}function Wo(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Qo(e){this.l=e||Xo,e=hi.PerformanceNavigationTiming?0<(e=hi.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(hi.g&&hi.g.Ga&&hi.g.Ga()&&hi.g.Ga().$b),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(oi=zo.prototype).add=function(e,t){$o(this),this.i=null,e=Wo(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},oi.forEach=function(e,t){$o(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},oi.oa=function(){$o(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},oi.W=function(e){$o(this);let t=[];if("string"==typeof e)Ho(this,e)&&(t=t.concat(this.g.get(Wo(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},oi.set=function(e,t){return $o(this),this.i=null,Ho(this,e=Wo(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},oi.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},oi.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.W(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var Xo=10;function Jo(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Yo(e){return e.h?1:e.g?e.g.size:0}function Zo(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ea(e,t){e.g?e.g.add(t):e.h=t}function ta(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function na(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return Ei(e.i)}function ra(){}function ia(){this.g=new ra}function sa(e,t,n){const r=n||"";try{Co(e,(function(e,n){let i=e;fi(e)&&(i=Es(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function oa(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function aa(e){this.l=e.ac||null,this.j=e.jb||!1}function ca(e,t){bs.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=ua,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}Qo.prototype.cancel=function(){if(this.i=na(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},ra.prototype.stringify=function(e){return hi.JSON.stringify(e,void 0)},ra.prototype.parse=function(e){return hi.JSON.parse(e,void 0)},bi(aa,to),aa.prototype.g=function(){return new ca(this.l,this.j)},aa.prototype.i=function(e){return function(){return e}}({}),bi(ca,bs);var ua=0;function ha(e){e.j.read().then(e.Ta.bind(e)).catch(e.ga.bind(e))}function la(e){e.readyState=4,e.l=null,e.j=null,e.A=null,da(e)}function da(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(oi=ca.prototype).open=function(e,t){if(this.readyState!=ua)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,da(this)},oi.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||hi).fetch(new Request(this.B,t)).then(this.Wa.bind(this),this.ga.bind(this))},oi.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,la(this)),this.readyState=ua},oi.Wa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,da(this)),this.g&&(this.readyState=3,da(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ua.bind(this),this.ga.bind(this));else if(void 0!==hi.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ha(this)}else e.text().then(this.Va.bind(this),this.ga.bind(this))},oi.Ta=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?la(this):da(this),3==this.readyState&&ha(this)}},oi.Va=function(e){this.g&&(this.response=this.responseText=e,la(this))},oi.Ua=function(e){this.g&&(this.response=e,la(this))},oi.ga=function(){this.g&&la(this)},oi.setRequestHeader=function(e,t){this.v.append(e,t)},oi.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},oi.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ca.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var fa=hi.JSON.parse;function pa(e){bs.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ga,this.K=this.L=!1}bi(pa,bs);var ga="",ma=/^https?$/i,ya=["POST","PUT"];function va(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,wa(e),Ia(e)}function wa(e){e.D||(e.D=!0,Is(e,"complete"),Is(e,"error"))}function ba(e){if(e.h&&void 0!==ui&&(!e.C[1]||4!=Ea(e)||2!=e.aa()))if(e.v&&4==Ea(e))Ps(e.Ha,0,e);else if(Is(e,"readystatechange"),4==Ea(e)){e.h=!1;try{const a=e.aa();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.H).match(ko)[1]||null;if(!i&&hi.self&&hi.self.location){var s=hi.self.location.protocol;i=s.substr(0,s.length-1)}r=!ma.test(i?i.toLowerCase():"")}n=r}if(n)Is(e,"complete"),Is(e,"success");else{e.m=6;try{var o=2<Ea(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.aa()+"]",wa(e)}}finally{Ia(e)}}}function Ia(e,t){if(e.g){Ta(e);const n=e.g,r=e.C[0]?li:null;e.g=null,e.C=null,t||Is(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function Ta(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(hi.clearTimeout(e.A),e.A=null)}function Ea(e){return e.g?e.g.readyState:0}function _a(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case ga:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Sa(e){let t="";return ts(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Ca(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Sa(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):Oo(e,t,n))}function ka(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Aa(e){this.Ca=0,this.i=[],this.j=new qs,this.ka=this.sa=this.F=this.V=this.g=this.za=this.D=this.ia=this.o=this.S=this.s=null,this.ab=this.U=0,this.Za=ka("failFast",!1,e),this.L=this.v=this.u=this.m=this.l=null,this.Y=!0,this.pa=this.Ba=this.T=-1,this.Z=this.A=this.C=0,this.Xa=ka("baseRetryDelayMs",5e3,e),this.bb=ka("retryDelaySeedMs",1e4,e),this.$a=ka("forwardChannelMaxRetries",2,e),this.ta=ka("forwardChannelRequestTimeoutMs",2e4,e),this.ra=e&&e.xmlHttpFactory||void 0,this.Da=e&&e.Zb||!1,this.J=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.I="",this.h=new Qo(e&&e.concurrentRequestLimit),this.Fa=new ia,this.O=e&&e.fastHandshake||!1,this.N=e&&e.encodeInitMessageHeaders||!1,this.O&&this.N&&(this.N=!1),this.Ya=e&&e.Xb||!1,e&&e.Aa&&this.j.Aa(),e&&e.forceLongPolling&&(this.Y=!1),this.$=!this.O&&this.Y&&e&&e.detectBufferingProxy||!1,this.ja=void 0,this.P=0,this.K=!1,this.la=this.B=null}function Na(e){if(Ra(e),3==e.G){var t=e.U++,n=No(e.F);Oo(n,"SID",e.I),Oo(n,"RID",t),Oo(n,"TYPE","terminate"),La(e,n),(t=new uo(e,e.j,t,void 0)).K=2,t.v=Lo(No(n)),n=!1,hi.navigator&&hi.navigator.sendBeacon&&(n=hi.navigator.sendBeacon(t.v.toString(),"")),!n&&hi.Image&&((new Image).src=t.v,n=!0),n||(t.g=Ha(t.l,null),t.g.da(t.v)),t.F=Date.now(),bo(t)}$a(e)}function Da(e){e.g&&(Fa(e),e.g.cancel(),e.g=null)}function Ra(e){Da(e),e.u&&(hi.clearTimeout(e.u),e.u=null),ja(e),e.h.cancel(),e.m&&("number"==typeof e.m&&hi.clearTimeout(e.m),e.m=null)}function xa(e){Jo(e.h)||e.m||(e.m=!0,Ns(e.Ja,e),e.C=0)}function Oa(e,t){var n;n=t?t.m:e.U++;const r=No(e.F);Oo(r,"SID",e.I),Oo(r,"RID",n),Oo(r,"AID",e.T),La(e,r),e.o&&e.s&&Ca(r,e.o,e.s),n=new uo(e,e.j,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.i=t.D.concat(e.i)),t=Pa(e,n,1e3),n.setTimeout(Math.round(.5*e.ta)+Math.round(.5*e.ta*Math.random())),ea(e.h,n),go(n,r,t)}function La(e,t){e.ia&&ts(e.ia,(function(e,n){Oo(t,n,e)})),e.l&&Co({},(function(e,n){Oo(t,n,e)}))}function Pa(e,t,n){n=Math.min(e.i.length,n);var r=e.l?vi(e.l.Ra,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),s=!1;else try{sa(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function Ma(e){e.g||e.u||(e.Z=1,Ns(e.Ia,e),e.A=0)}function Ua(e){return!(e.g||e.u||3<=e.A||(e.Z++,e.u=Ys(vi(e.Ia,e),qa(e,e.A)),e.A++,0))}function Fa(e){null!=e.B&&(hi.clearTimeout(e.B),e.B=null)}function Va(e){e.g=new uo(e,e.j,"rpc",e.Z),null===e.o&&(e.g.H=e.s),e.g.N=0;var t=No(e.sa);Oo(t,"RID","rpc"),Oo(t,"SID",e.I),Oo(t,"CI",e.L?"0":"1"),Oo(t,"AID",e.T),Oo(t,"TYPE","xmlhttp"),La(e,t),e.o&&e.s&&Ca(t,e.o,e.s),e.J&&e.g.setTimeout(e.J);var n=e.g;e=e.ka,n.K=1,n.v=Lo(No(t)),n.s=null,n.P=!0,mo(n,e)}function ja(e){null!=e.v&&(hi.clearTimeout(e.v),e.v=null)}function Ba(e,t){var n=null;if(e.g==t){ja(e),Fa(e),e.g=null;var r=2}else{if(!Zo(e.h,t))return;n=t.D,ta(e.h,t),r=1}if(0!=e.G)if(e.pa=t.Y,t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Is(r=Hs(),new Js(r,n)),xa(e)}else Ma(e);else if(3==(i=t.o)||0==i&&0<e.pa||!(1==r&&function(e,t){return!(Yo(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.D.concat(e.i),0):1==e.G||2==e.G||e.C>=(e.Za?0:e.$a)||(e.m=Ys(vi(e.Ja,e,t),qa(e,e.C)),e.C++,0)))}(e,t)||2==r&&Ua(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:za(e,5);break;case 4:za(e,10);break;case 3:za(e,6);break;default:za(e,2)}}function qa(e,t){let n=e.Xa+Math.floor(Math.random()*e.bb);return e.l||(n*=2),n*t}function za(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=vi(e.kb,e);n||(n=new Ao("//www.google.com/images/cleardot.gif"),hi.location&&"http"==hi.location.protocol||Do(n,"https"),Lo(n)),function(e,t){const n=new qs;if(hi.Image){const r=new Image;r.onload=wi(oa,n,r,"TestLoadImage: loaded",!0,t),r.onerror=wi(oa,n,r,"TestLoadImage: error",!1,t),r.onabort=wi(oa,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=wi(oa,n,r,"TestLoadImage: timeout",!1,t),hi.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else Xs(2);e.G=0,e.l&&e.l.va(t),$a(e),Ra(e)}function $a(e){if(e.G=0,e.la=[],e.l){const t=na(e.h);0==t.length&&0==e.i.length||(_i(e.la,t),_i(e.la,e.i),e.h.i.length=0,Ei(e.i),e.i.length=0),e.l.ua()}}function Ka(e,t,n){var r=n instanceof Ao?No(n):new Ao(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),Ro(r,r.m);else{var i=hi.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new Ao(null,void 0);r&&Do(s,r),t&&(s.g=t),i&&Ro(s,i),n&&(s.l=n),r=s}return n=e.D,t=e.za,n&&t&&Oo(r,n,t),Oo(r,"VER",e.ma),La(e,r),r}function Ha(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Da&&!e.ra?new pa(new aa({jb:!0})):new pa(e.ra)).Ka(e.H),t}function Ga(){}function Wa(){if(Mi&&!(10<=Number(Wi)))throw Error("Environmental error: no available transport.")}function Qa(e,t){bs.call(this),this.g=new Aa(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.S=e,(e=t&&t.Yb)&&!ki(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!ki(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new Ya(this)}function Xa(e){oo.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function Ja(){ao.call(this),this.status=1}function Ya(e){this.g=e}(oi=pa.prototype).Ka=function(e){this.L=e},oi.da=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():io.g(),this.C=this.u?no(this.u):no(io),this.g.onreadystatechange=vi(this.Ha,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void va(this,e)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=hi.FormData&&e instanceof hi.FormData,!(0<=Ti(ya,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[e,t]of n)this.g.setRequestHeader(e,t);this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Ta(this),0<this.B&&((this.K=function(e){return Mi&&Gi()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=vi(this.qa,this)):this.A=Ps(this.qa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){va(this,e)}},oi.qa=function(){void 0!==ui&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Is(this,"timeout"),this.abort(8))},oi.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Is(this,"complete"),Is(this,"abort"),Ia(this))},oi.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Ia(this,!0)),pa.X.M.call(this)},oi.Ha=function(){this.s||(this.F||this.v||this.l?ba(this):this.fb())},oi.fb=function(){ba(this)},oi.aa=function(){try{return 2<Ea(this)?this.g.status:-1}catch(e){return-1}},oi.fa=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},oi.Sa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),fa(t)}},oi.Ea=function(){return this.m},oi.Oa=function(){return"string"==typeof this.j?this.j:String(this.j)},(oi=Aa.prototype).ma=8,oi.G=1,oi.Ja=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new uo(this,this.j,e,void 0);let s=this.s;if(this.S&&(s?(s=ns(s),is(s,this.S)):s=this.S),null!==this.o||this.N||(i.H=s,s=null),this.O)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Pa(this,i,t),Oo(n=No(this.F),"RID",e),Oo(n,"CVER",22),this.D&&Oo(n,"X-HTTP-Session-Id",this.D),La(this,n),s&&(this.N?t="headers="+encodeURIComponent(String(Sa(s)))+"&"+t:this.o&&Ca(n,this.o,s)),ea(this.h,i),this.Ya&&Oo(n,"TYPE","init"),this.O?(Oo(n,"$req",t),Oo(n,"SID","null"),i.Z=!0,go(i,n,null)):go(i,n,t),this.G=2}}else 3==this.G&&(e?Oa(this,e):0==this.i.length||Jo(this.h)||Oa(this))},oi.Ia=function(){if(this.u=null,Va(this),this.$&&!(this.K||null==this.g||0>=this.P)){var e=2*this.P;this.j.info("BP detection timer enabled: "+e),this.B=Ys(vi(this.eb,this),e)}},oi.eb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.L=!1,this.K=!0,Xs(10),Da(this),Va(this))},oi.cb=function(){null!=this.v&&(this.v=null,Da(this),Ua(this),Xs(19))},oi.kb=function(e){e?(this.j.info("Successfully pinged google.com"),Xs(2)):(this.j.info("Failed to ping google.com"),Xs(1))},(oi=Ga.prototype).xa=function(){},oi.wa=function(){},oi.va=function(){},oi.ua=function(){},oi.Ra=function(){},Wa.prototype.g=function(e,t){return new Qa(e,t)},bi(Qa,bs),Qa.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;Xs(0),e.V=t,e.ia=n||{},e.L=e.Y,e.F=Ka(e,null,e.V),xa(e)},Qa.prototype.close=function(){Na(this.g)},Qa.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=Es(e),e=n);t.i.push(new class{constructor(e,t){this.h=e,this.g=t}}(t.ab++,e)),3==t.G&&xa(t)},Qa.prototype.M=function(){this.g.l=null,delete this.j,Na(this.g),delete this.g,Qa.X.M.call(this)},bi(Xa,oo),bi(Ja,ao),bi(Ya,Ga),Ya.prototype.xa=function(){Is(this.g,"a")},Ya.prototype.wa=function(e){Is(this.g,new Xa(e))},Ya.prototype.va=function(e){Is(this.g,new Ja)},Ya.prototype.ua=function(){Is(this.g,"b")},Wa.prototype.createWebChannel=Wa.prototype.g,Qa.prototype.send=Qa.prototype.u,Qa.prototype.open=Qa.prototype.m,Qa.prototype.close=Qa.prototype.close,Zs.NO_ERROR=0,Zs.TIMEOUT=8,Zs.HTTP_ERROR=6,eo.COMPLETE="complete",ro.EventType=so,so.OPEN="a",so.CLOSE="b",so.ERROR="c",so.MESSAGE="d",bs.prototype.listen=bs.prototype.N,pa.prototype.listenOnce=pa.prototype.O,pa.prototype.getLastError=pa.prototype.Oa,pa.prototype.getLastErrorCode=pa.prototype.Ea,pa.prototype.getStatus=pa.prototype.aa,pa.prototype.getResponseJson=pa.prototype.Sa,pa.prototype.getResponseText=pa.prototype.fa,pa.prototype.send=pa.prototype.da,pa.prototype.setWithCredentials=pa.prototype.Ka;var Za=ci.createWebChannelTransport=function(){return new Wa},ec=ci.getStatEventTarget=function(){return Hs()},tc=ci.ErrorCode=Zs,nc=ci.EventType=eo,rc=ci.Event=$s,ic=ci.Stat={sb:0,vb:1,wb:2,Pb:3,Ub:4,Rb:5,Sb:6,Qb:7,Ob:8,Tb:9,PROXY:10,NOPROXY:11,Mb:12,Ib:13,Jb:14,Hb:15,Kb:16,Lb:17,ob:18,nb:19,pb:20},sc=ci.FetchXmlHttpFactory=aa,oc=ci.WebChannel=ro,ac=ci.XhrIo=pa;const cc="@firebase/firestore";class uc{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}uc.UNAUTHENTICATED=new uc(null),uc.GOOGLE_CREDENTIALS=new uc("google-credentials-uid"),uc.FIRST_PARTY=new uc("first-party-uid"),uc.MOCK_USER=new uc("mock-user");let hc="9.14.0";const lc=new M("@firebase/firestore");function dc(){return lc.logLevel}function fc(e,...t){if(lc.logLevel<=D.DEBUG){const n=t.map(mc);lc.debug(`Firestore (${hc}): ${e}`,...n)}}function pc(e,...t){if(lc.logLevel<=D.ERROR){const n=t.map(mc);lc.error(`Firestore (${hc}): ${e}`,...n)}}function gc(e,...t){if(lc.logLevel<=D.WARN){const n=t.map(mc);lc.warn(`Firestore (${hc}): ${e}`,...n)}}function mc(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function yc(e="Unexpected state"){const t=`FIRESTORE (${hc}) INTERNAL ASSERTION FAILED: `+e;throw pc(t),new Error(t)}function vc(e,t){e||yc()}function wc(e,t){return e}const bc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ic extends f{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Tc{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class Ec{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class _c{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(uc.UNAUTHENTICATED)))}shutdown(){}}class Sc{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Cc{constructor(e){this.t=e,this.currentUser=uc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Tc;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Tc,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{fc("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(fc("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Tc)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(fc("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(vc("string"==typeof t.accessToken),new Ec(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return vc(null===e||"string"==typeof e),new uc(e)}}class kc{constructor(e,t,n,r){this.h=e,this.l=t,this.m=n,this.g=r,this.type="FirstParty",this.user=uc.FIRST_PARTY,this.p=new Map}I(){return this.g?this.g():(vc(!("object"!=typeof this.h||null===this.h||!this.h.auth||!this.h.auth.getAuthHeaderValueForFirstParty)),this.h.auth.getAuthHeaderValueForFirstParty([]))}get headers(){this.p.set("X-Goog-AuthUser",this.l);const e=this.I();return e&&this.p.set("Authorization",e),this.m&&this.p.set("X-Goog-Iam-Authorization-Token",this.m),this.p}}class Ac{constructor(e,t,n,r){this.h=e,this.l=t,this.m=n,this.g=r}getToken(){return Promise.resolve(new kc(this.h,this.l,this.m,this.g))}start(e,t){e.enqueueRetryable((()=>t(uc.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Nc{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Dc{constructor(e){this.T=e,this.forceRefresh=!1,this.appCheck=null,this.A=null}start(e,t){const n=e=>{null!=e.error&&fc("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.A;return this.A=e.token,fc("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{fc("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.T.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.T.getImmediate({optional:!0});e?r(e):fc("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(vc("string"==typeof e.token),this.A=e.token,new Nc(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}function Rc(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}class xc{static R(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=Rc(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function Oc(e,t){return e<t?-1:e>t?1:0}function Lc(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Pc{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ic(bc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ic(bc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Ic(bc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ic(bc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Pc.fromMillis(Date.now())}static fromDate(e){return Pc.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Pc(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Oc(this.nanoseconds,e.nanoseconds):Oc(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Mc{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Mc(e)}static min(){return new Mc(new Pc(0,0))}static max(){return new Mc(new Pc(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Uc{constructor(e,t,n){void 0===t?t=0:t>e.length&&yc(),void 0===n?n=e.length-t:n>e.length-t&&yc(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Uc.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Uc?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Fc extends Uc{construct(e,t,n){return new Fc(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ic(bc.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Fc(t)}static emptyPath(){return new Fc([])}}const Vc=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jc extends Uc{construct(e,t,n){return new jc(e,t,n)}static isValidIdentifier(e){return Vc.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jc.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new jc(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Ic(bc.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Ic(bc.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Ic(bc.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Ic(bc.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jc(t)}static emptyPath(){return new jc([])}}class Bc{constructor(e){this.path=e}static fromPath(e){return new Bc(Fc.fromString(e))}static fromName(e){return new Bc(Fc.fromString(e).popFirst(5))}static empty(){return new Bc(Fc.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Fc.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Fc.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Bc(new Fc(e.slice()))}}function qc(e){return new zc(e.readTime,e.key,-1)}class zc{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new zc(Mc.min(),Bc.empty(),-1)}static max(){return new zc(Mc.max(),Bc.empty(),-1)}}function $c(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Bc.comparator(e.documentKey,t.documentKey),0!==n?n:Oc(e.largestBatchId,t.largestBatchId))}class Kc{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Hc(e){if(e.code!==bc.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;fc("LocalStore","Unexpectedly lost primary lease")}class Gc{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&yc(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Gc(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Gc?t:Gc.resolve(t)}catch(e){return Gc.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Gc.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Gc.reject(t)}static resolve(e){return new Gc(((t,n)=>{t(e)}))}static reject(e){return new Gc(((t,n)=>{n(e)}))}static waitFor(e){return new Gc(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Gc.resolve(!1);for(const n of e)t=t.next((e=>e?Gc.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Gc(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new Gc(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function Wc(e){return"IndexedDbTransactionError"===e.name}class Qc{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ut(e),this.ct=e=>t.writeSequenceNumber(e))}ut(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ct&&this.ct(e),e}}function Xc(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Jc(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}Qc.at=-1;class Yc{constructor(e,t){this.comparator=e,this.root=t||eu.EMPTY}insert(e,t){return new Yc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,eu.BLACK,null,null))}remove(e){return new Yc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,eu.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zc(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zc(this.root,e,this.comparator,!0)}}class Zc{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class eu{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:eu.RED,this.left=null!=r?r:eu.EMPTY,this.right=null!=i?i:eu.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new eu(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return eu.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return eu.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,eu.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,eu.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw yc();if(this.right.isRed())throw yc();const e=this.left.check();if(e!==this.right.check())throw yc();return e+(this.isRed()?0:1)}}eu.EMPTY=null,eu.RED=!0,eu.BLACK=!1,eu.EMPTY=new class{constructor(){this.size=0}get key(){throw yc()}get value(){throw yc()}get color(){throw yc()}get left(){throw yc()}get right(){throw yc()}copy(e,t,n,r,i){return this}insert(e,t,n){return new eu(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class tu{constructor(e){this.comparator=e,this.data=new Yc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nu(this.data.getIterator())}getIteratorFrom(e){return new nu(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof tu))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new tu(this.comparator);return t.data=e,t}}class nu{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ru{constructor(e){this.fields=e,e.sort(jc.comparator)}static empty(){return new ru([])}unionWith(e){let t=new tu(jc.comparator);for(const e of this.fields)t=t.add(e);for(const n of e)t=t.add(n);return new ru(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Lc(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class iu{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new iu(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new iu(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oc(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}iu.EMPTY_BYTE_STRING=new iu("");const su=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ou(e){if(vc(!!e),"string"==typeof e){let t=0;const n=su.exec(e);if(vc(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:au(e.seconds),nanos:au(e.nanos)}}function au(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function cu(e){return"string"==typeof e?iu.fromBase64String(e):iu.fromUint8Array(e)}function uu(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function hu(e){const t=e.mapValue.fields.__previous_value__;return uu(t)?hu(t):t}function lu(e){const t=ou(e.mapValue.fields.__local_write_time__.timestampValue);return new Pc(t.seconds,t.nanos)}class du{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class fu{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new fu("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof fu&&e.projectId===this.projectId&&e.database===this.database}}function pu(e){return null==e}function gu(e){return 0===e&&1/e==-1/0}const mu={fields:{__type__:{stringValue:"__max__"}}};function yu(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?uu(e)?4:Du(e)?9007199254740991:10:yc()}function vu(e,t){if(e===t)return!0;const n=yu(e);if(n!==yu(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return lu(e).isEqual(lu(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ou(e.timestampValue),r=ou(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return cu(e.bytesValue).isEqual(cu(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return au(e.geoPointValue.latitude)===au(t.geoPointValue.latitude)&&au(e.geoPointValue.longitude)===au(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return au(e.integerValue)===au(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=au(e.doubleValue),r=au(t.doubleValue);return n===r?gu(n)===gu(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Lc(e.arrayValue.values||[],t.arrayValue.values||[],vu);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Xc(n)!==Xc(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!vu(n[e],r[e])))return!1;return!0}(e,t);default:return yc()}}function wu(e,t){return void 0!==(e.values||[]).find((e=>vu(e,t)))}function bu(e,t){if(e===t)return 0;const n=yu(e),r=yu(t);if(n!==r)return Oc(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Oc(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=au(e.integerValue||e.doubleValue),r=au(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Iu(e.timestampValue,t.timestampValue);case 4:return Iu(lu(e),lu(t));case 5:return Oc(e.stringValue,t.stringValue);case 6:return function(e,t){const n=cu(e),r=cu(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=Oc(n[e],r[e]);if(0!==t)return t}return Oc(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=Oc(au(e.latitude),au(t.latitude));return 0!==n?n:Oc(au(e.longitude),au(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=bu(n[e],r[e]);if(t)return t}return Oc(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===mu&&t===mu)return 0;if(e===mu)return 1;if(t===mu)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=Oc(r[e],s[e]);if(0!==t)return t;const o=bu(n[r[e]],i[s[e]]);if(0!==o)return o}return Oc(r.length,s.length)}(e.mapValue,t.mapValue);default:throw yc()}}function Iu(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Oc(e,t);const n=ou(e),r=ou(t),i=Oc(n.seconds,r.seconds);return 0!==i?i:Oc(n.nanos,r.nanos)}function Tu(e){return Eu(e)}function Eu(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ou(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?cu(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Bc.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Eu(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Eu(e.fields[i])}`;return n+"}"}(e.mapValue):yc();var t,n}function _u(e){return!!e&&"integerValue"in e}function Su(e){return!!e&&"arrayValue"in e}function Cu(e){return!!e&&"nullValue"in e}function ku(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Au(e){return!!e&&"mapValue"in e}function Nu(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Jc(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=Nu(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Nu(e.arrayValue.values[n]);return t}return Object.assign({},e)}function Du(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class Ru{constructor(e){this.value=e}static empty(){return new Ru({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Au(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nu(t)}setAll(e){let t=jc.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Nu(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Au(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return vu(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Au(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Jc(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ru(Nu(this.value))}}class xu{constructor(e,t,n,r,i,s){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.data=i,this.documentState=s}static newInvalidDocument(e){return new xu(e,0,Mc.min(),Mc.min(),Ru.empty(),0)}static newFoundDocument(e,t,n){return new xu(e,1,t,Mc.min(),n,0)}static newNoDocument(e,t){return new xu(e,2,t,Mc.min(),Ru.empty(),0)}static newUnknownDocument(e,t){return new xu(e,3,t,Mc.min(),Ru.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ru.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ru.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Mc.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof xu&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new xu(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ou{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ht=null}}function Lu(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Ou(e,t,n,r,i,s,o)}function Pu(e){const t=wc(e);if(null===t.ht){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>{return(t=e).field.canonicalString()+t.op.toString()+Tu(t.value);var t})).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),pu(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Tu(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Tu(e))).join(",")),t.ht=e}return t.ht}function Mu(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Qu(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!vu(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ju(e.startAt,t.startAt)&&Ju(e.endAt,t.endAt)}function Uu(e){return Bc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Fu extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.lt(e,t,n):new Vu(e,t,n):"array-contains"===t?new zu(e,n):"in"===t?new $u(e,n):"not-in"===t?new Ku(e,n):"array-contains-any"===t?new Hu(e,n):new Fu(e,t,n)}static lt(e,t,n){return"in"===t?new ju(e,n):new Bu(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.ft(bu(t,this.value)):null!==t&&yu(this.value)===yu(t)&&this.ft(bu(t,this.value))}ft(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return yc()}}dt(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Vu extends Fu{constructor(e,t,n){super(e,t,n),this.key=Bc.fromName(n.referenceValue)}matches(e){const t=Bc.comparator(e.key,this.key);return this.ft(t)}}class ju extends Fu{constructor(e,t){super(e,"in",t),this.keys=qu(0,t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Bu extends Fu{constructor(e,t){super(e,"not-in",t),this.keys=qu(0,t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function qu(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Bc.fromName(e.referenceValue)))}class zu extends Fu{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Su(t)&&wu(t.arrayValue,this.value)}}class $u extends Fu{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&wu(this.value.arrayValue,t)}}class Ku extends Fu{constructor(e,t){super(e,"not-in",t)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!wu(this.value.arrayValue,t)}}class Hu extends Fu{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Su(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>wu(this.value.arrayValue,e)))}}class Gu{constructor(e,t){this.position=e,this.inclusive=t}}class Wu{constructor(e,t="asc"){this.field=e,this.dir=t}}function Qu(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Xu(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Bc.comparator(Bc.fromName(o.referenceValue),n.key):bu(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Ju(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!vu(e.position[n],t.position[n]))return!1;return!0}class Yu{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this._t=null,this.wt=null,this.startAt,this.endAt}}function Zu(e){return new Yu(e)}function eh(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function th(e){const t=wc(e);if(null===t._t){t._t=[];const e=function(e){for(const t of e.filters)if(t.dt())return t.field;return null}(t),n=function(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}(t);if(null!==e&&null===n)e.isKeyField()||t._t.push(new Wu(e)),t._t.push(new Wu(jc.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t._t.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t._t.push(new Wu(jc.keyField(),e))}}}return t._t}function nh(e){const t=wc(e);if(!t.wt)if("F"===t.limitType)t.wt=Lu(t.path,t.collectionGroup,th(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of th(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Wu(n.field,t))}const n=t.endAt?new Gu(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Gu(t.startAt.position,t.startAt.inclusive):null;t.wt=Lu(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.wt}function rh(e,t,n){return new Yu(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ih(e,t){return Mu(nh(e),nh(t))&&e.limitType===t.limitType}function sh(e){return`${Pu(nh(e))}|lt:${e.limitType}`}function oh(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${Tu(t.value)}`;var t})).join(", ")}]`),pu(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Tu(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Tu(e))).join(",")),`Target(${t})`}(nh(e))}; limitType=${e.limitType})`}function ah(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Bc.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Xu(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,th(e),t)||e.endAt&&!function(e,t,n){const r=Xu(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,th(e),t))}(e,t)}function ch(e){return(t,n)=>{let r=!1;for(const i of th(e)){const e=uh(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function uh(e,t,n){const r=e.field.isKeyField()?Bc.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?bu(r,i):yc()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return yc()}}class hh{constructor(){this._=void 0}}function lh(e,t,n){return e instanceof fh?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof ph?gh(e,t):e instanceof mh?yh(e,t):function(e,t){const n=function(e,t){return e instanceof vh?_u(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}(e,t),r=wh(n)+wh(e.yt);return _u(n)&&_u(e.yt)?function(e){return{integerValue:""+e}}(r):function(e,t){if(e.gt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:gu(t)?"-0":t}}(e.It,r)}(e,t)}function dh(e,t,n){return e instanceof ph?gh(e,t):e instanceof mh?yh(e,t):n}class fh extends hh{}class ph extends hh{constructor(e){super(),this.elements=e}}function gh(e,t){const n=bh(t);for(const t of e.elements)n.some((e=>vu(e,t)))||n.push(t);return{arrayValue:{values:n}}}class mh extends hh{constructor(e){super(),this.elements=e}}function yh(e,t){let n=bh(t);for(const t of e.elements)n=n.filter((e=>!vu(e,t)));return{arrayValue:{values:n}}}class vh extends hh{constructor(e,t){super(),this.It=e,this.yt=t}}function wh(e){return au(e.integerValue||e.doubleValue)}function bh(e){return Su(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Ih{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Ih}static exists(e){return new Ih(void 0,e)}static updateTime(e){return new Ih(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Th(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Eh{}function _h(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Oh(e.key,Ih.none()):new Ah(e.key,e.data,Ih.none());{const n=e.data,r=Ru.empty();let i=new tu(jc.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Nh(e.key,r,new ru(i.toArray()),Ih.none())}}function Sh(e,t,n){e instanceof Ah?function(e,t,n){const r=e.value.clone(),i=Rh(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Nh?function(e,t,n){if(!Th(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=Rh(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Dh(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ch(e,t,n,r){return e instanceof Ah?function(e,t,n,r){if(!Th(e.precondition,t))return n;const i=e.value.clone(),s=xh(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Nh?function(e,t,n,r){if(!Th(e.precondition,t))return n;const i=xh(e.fieldTransforms,r,t),s=t.data;return s.setAll(Dh(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Th(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function kh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Lc(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof ph&&t instanceof ph||e instanceof mh&&t instanceof mh?Lc(e.elements,t.elements,vu):e instanceof vh&&t instanceof vh?vu(e.yt,t.yt):e instanceof fh&&t instanceof fh}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ah extends Eh{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Nh extends Eh{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Dh(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function Rh(e,t,n){const r=new Map;vc(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,dh(o,a,n[i]))}return r}function xh(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,lh(e,s,t))}return r}class Oh extends Eh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Lh{constructor(e){this.count=e}}var Ph,Mh;function Uh(e){if(void 0===e)return pc("GRPC error has no .code"),bc.UNKNOWN;switch(e){case Ph.OK:return bc.OK;case Ph.CANCELLED:return bc.CANCELLED;case Ph.UNKNOWN:return bc.UNKNOWN;case Ph.DEADLINE_EXCEEDED:return bc.DEADLINE_EXCEEDED;case Ph.RESOURCE_EXHAUSTED:return bc.RESOURCE_EXHAUSTED;case Ph.INTERNAL:return bc.INTERNAL;case Ph.UNAVAILABLE:return bc.UNAVAILABLE;case Ph.UNAUTHENTICATED:return bc.UNAUTHENTICATED;case Ph.INVALID_ARGUMENT:return bc.INVALID_ARGUMENT;case Ph.NOT_FOUND:return bc.NOT_FOUND;case Ph.ALREADY_EXISTS:return bc.ALREADY_EXISTS;case Ph.PERMISSION_DENIED:return bc.PERMISSION_DENIED;case Ph.FAILED_PRECONDITION:return bc.FAILED_PRECONDITION;case Ph.ABORTED:return bc.ABORTED;case Ph.OUT_OF_RANGE:return bc.OUT_OF_RANGE;case Ph.UNIMPLEMENTED:return bc.UNIMPLEMENTED;case Ph.DATA_LOSS:return bc.DATA_LOSS;default:return yc()}}(Mh=Ph||(Ph={}))[Mh.OK=0]="OK",Mh[Mh.CANCELLED=1]="CANCELLED",Mh[Mh.UNKNOWN=2]="UNKNOWN",Mh[Mh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mh[Mh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mh[Mh.NOT_FOUND=5]="NOT_FOUND",Mh[Mh.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mh[Mh.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mh[Mh.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mh[Mh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mh[Mh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mh[Mh.ABORTED=10]="ABORTED",Mh[Mh.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mh[Mh.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mh[Mh.INTERNAL=13]="INTERNAL",Mh[Mh.UNAVAILABLE=14]="UNAVAILABLE",Mh[Mh.DATA_LOSS=15]="DATA_LOSS";class Fh{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Jc(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(this.inner)}size(){return this.innerSize}}const Vh=new Yc(Bc.comparator);function jh(){return Vh}const Bh=new Yc(Bc.comparator);function qh(...e){let t=Bh;for(const n of e)t=t.insert(n.key,n);return t}function zh(e){let t=Bh;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function $h(){return Hh()}function Kh(){return Hh()}function Hh(){return new Fh((e=>e.toString()),((e,t)=>e.isEqual(t)))}new Yc(Bc.comparator);const Gh=new tu(Bc.comparator);function Wh(...e){let t=Gh;for(const n of e)t=t.add(n);return t}const Qh=new tu(Oc);function Xh(){return Qh}class Jh{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Yh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Jh(Mc.min(),r,Xh(),jh(),Wh())}}class Yh{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Yh(n,t,Wh(),Wh(),Wh())}}class Zh{constructor(e,t,n,r){this.Tt=e,this.removedTargetIds=t,this.key=n,this.Et=r}}class el{constructor(e,t){this.targetId=e,this.At=t}}class tl{constructor(e,t,n=iu.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class nl{constructor(){this.Rt=0,this.bt=sl(),this.Pt=iu.EMPTY_BYTE_STRING,this.vt=!1,this.Vt=!0}get current(){return this.vt}get resumeToken(){return this.Pt}get St(){return 0!==this.Rt}get Dt(){return this.Vt}Ct(e){e.approximateByteSize()>0&&(this.Vt=!0,this.Pt=e)}xt(){let e=Wh(),t=Wh(),n=Wh();return this.bt.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:yc()}})),new Yh(this.Pt,this.vt,e,t,n)}Nt(){this.Vt=!1,this.bt=sl()}kt(e,t){this.Vt=!0,this.bt=this.bt.insert(e,t)}Ot(e){this.Vt=!0,this.bt=this.bt.remove(e)}Mt(){this.Rt+=1}Ft(){this.Rt-=1}$t(){this.Vt=!0,this.vt=!0}}class rl{constructor(e){this.Bt=e,this.Lt=new Map,this.Ut=jh(),this.qt=il(),this.Kt=new tu(Oc)}Gt(e){for(const t of e.Tt)e.Et&&e.Et.isFoundDocument()?this.Qt(t,e.Et):this.jt(t,e.key,e.Et);for(const t of e.removedTargetIds)this.jt(t,e.key,e.Et)}Wt(e){this.forEachTarget(e,(t=>{const n=this.zt(t);switch(e.state){case 0:this.Ht(t)&&n.Ct(e.resumeToken);break;case 1:n.Ft(),n.St||n.Nt(),n.Ct(e.resumeToken);break;case 2:n.Ft(),n.St||this.removeTarget(t);break;case 3:this.Ht(t)&&(n.$t(),n.Ct(e.resumeToken));break;case 4:this.Ht(t)&&(this.Jt(t),n.Ct(e.resumeToken));break;default:yc()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Lt.forEach(((e,n)=>{this.Ht(n)&&t(n)}))}Yt(e){const t=e.targetId,n=e.At.count,r=this.Xt(t);if(r){const e=r.target;if(Uu(e))if(0===n){const n=new Bc(e.path);this.jt(t,n,xu.newNoDocument(n,Mc.min()))}else vc(1===n);else this.Zt(t)!==n&&(this.Jt(t),this.Kt=this.Kt.add(t))}}te(e){const t=new Map;this.Lt.forEach(((n,r)=>{const i=this.Xt(r);if(i){if(n.current&&Uu(i.target)){const t=new Bc(i.target.path);null!==this.Ut.get(t)||this.ee(r,t)||this.jt(r,t,xu.newNoDocument(t,e))}n.Dt&&(t.set(r,n.xt()),n.Nt())}}));let n=Wh();this.qt.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Xt(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.Ut.forEach(((t,n)=>n.setReadTime(e)));const r=new Jh(e,t,this.Kt,this.Ut,n);return this.Ut=jh(),this.qt=il(),this.Kt=new tu(Oc),r}Qt(e,t){if(!this.Ht(e))return;const n=this.ee(e,t.key)?2:0;this.zt(e).kt(t.key,n),this.Ut=this.Ut.insert(t.key,t),this.qt=this.qt.insert(t.key,this.ne(t.key).add(e))}jt(e,t,n){if(!this.Ht(e))return;const r=this.zt(e);this.ee(e,t)?r.kt(t,1):r.Ot(t),this.qt=this.qt.insert(t,this.ne(t).delete(e)),n&&(this.Ut=this.Ut.insert(t,n))}removeTarget(e){this.Lt.delete(e)}Zt(e){const t=this.zt(e).xt();return this.Bt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Mt(e){this.zt(e).Mt()}zt(e){let t=this.Lt.get(e);return t||(t=new nl,this.Lt.set(e,t)),t}ne(e){let t=this.qt.get(e);return t||(t=new tu(Oc),this.qt=this.qt.insert(e,t)),t}Ht(e){const t=null!==this.Xt(e);return t||fc("WatchChangeAggregator","Detected inactive target",e),t}Xt(e){const t=this.Lt.get(e);return t&&t.St?null:this.Bt.se(e)}Jt(e){this.Lt.set(e,new nl),this.Bt.getRemoteKeysForTarget(e).forEach((t=>{this.jt(e,t,null)}))}ee(e,t){return this.Bt.getRemoteKeysForTarget(e).has(t)}}function il(){return new Yc(Bc.comparator)}function sl(){return new Yc(Bc.comparator)}const ol={asc:"ASCENDING",desc:"DESCENDING"},al={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class cl{constructor(e,t){this.databaseId=e,this.gt=t}}function ul(e){return vc(!!e),Mc.fromTimestamp(function(e){const t=ou(e);return new Pc(t.seconds,t.nanos)}(e))}function hl(e){const t=Fc.fromString(e);return vc(Sl(t)),t}function ll(e,t){const n=hl(t);if(n.get(1)!==e.databaseId.projectId)throw new Ic(bc.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Ic(bc.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Bc(pl(n))}function dl(e,t){return function(e,t){return function(e){return new Fc(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}(e.databaseId,t)}function fl(e){return new Fc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function pl(e){return vc(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function gl(e,t){return{documents:[dl(e,t.path)]}}function ml(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=dl(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=dl(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(ku(e.value))return{unaryFilter:{field:Il(e.field),op:"IS_NAN"}};if(Cu(e.value))return{unaryFilter:{field:Il(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(ku(e.value))return{unaryFilter:{field:Il(e.field),op:"IS_NOT_NAN"}};if(Cu(e.value))return{unaryFilter:{field:Il(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Il(e.field),op:bl(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Il(e.field),direction:wl(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.gt||pu(t)?t:{value:t}}(e,t.limit);var a;return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt={before:(a=t.startAt).inclusive,values:a.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function yl(e){let t=function(e){const t=hl(e);return 4===t.length?Fc.emptyPath():pl(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){vc(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=vl(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Wu(Tl(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,pu(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Gu(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Gu(n,t)}(n.endAt)),function(e,t,n,r,i,s,o,a){return new Yu(e,t,n,r,i,s,o,a)}(t,i,o,s,a,"F",c,u)}function vl(e){return e?void 0!==e.unaryFilter?[_l(e)]:void 0!==e.fieldFilter?[El(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>vl(e))).reduce(((e,t)=>e.concat(t))):yc():[]}function wl(e){return ol[e]}function bl(e){return al[e]}function Il(e){return{fieldPath:e.canonicalString()}}function Tl(e){return jc.fromServerFormat(e.fieldPath)}function El(e){return Fu.create(Tl(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return yc()}}(e.fieldFilter.op),e.fieldFilter.value)}function _l(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Tl(e.unaryFilter.field);return Fu.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Tl(e.unaryFilter.field);return Fu.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Tl(e.unaryFilter.field);return Fu.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Tl(e.unaryFilter.field);return Fu.create(i,"!=",{nullValue:"NULL_VALUE"});default:return yc()}}function Sl(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Cl{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&Sh(r,e,n[t])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Ch(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Ch(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Kh();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=_h(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Mc.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Wh())}isEqual(e){return this.batchId===e.batchId&&Lc(this.mutations,e.mutations,((e,t)=>kh(e,t)))&&Lc(this.baseMutations,e.baseMutations,((e,t)=>kh(e,t)))}}class kl{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Al{constructor(e,t,n,r,i=Mc.min(),s=Mc.min(),o=iu.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new Al(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Al(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Al(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Nl{constructor(e){this.re=e}}function Dl(e){const t=yl({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?rh(t,t.limit,"L"):t}class Rl{constructor(){}ce(e,t){this.ae(e,t),t.he()}ae(e,t){if("nullValue"in e)this.le(t,5);else if("booleanValue"in e)this.le(t,10),t.fe(e.booleanValue?1:0);else if("integerValue"in e)this.le(t,15),t.fe(au(e.integerValue));else if("doubleValue"in e){const n=au(e.doubleValue);isNaN(n)?this.le(t,13):(this.le(t,15),gu(n)?t.fe(0):t.fe(n))}else if("timestampValue"in e){const n=e.timestampValue;this.le(t,20),"string"==typeof n?t.de(n):(t.de(`${n.seconds||""}`),t.fe(n.nanos||0))}else if("stringValue"in e)this._e(e.stringValue,t),this.we(t);else if("bytesValue"in e)this.le(t,30),t.me(cu(e.bytesValue)),this.we(t);else if("referenceValue"in e)this.ge(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.le(t,45),t.fe(n.latitude||0),t.fe(n.longitude||0)}else"mapValue"in e?Du(e)?this.le(t,Number.MAX_SAFE_INTEGER):(this.ye(e.mapValue,t),this.we(t)):"arrayValue"in e?(this.pe(e.arrayValue,t),this.we(t)):yc()}_e(e,t){this.le(t,25),this.Ie(e,t)}Ie(e,t){t.de(e)}ye(e,t){const n=e.fields||{};this.le(t,55);for(const e of Object.keys(n))this._e(e,t),this.ae(n[e],t)}pe(e,t){const n=e.values||[];this.le(t,50);for(const e of n)this.ae(e,t)}ge(e,t){this.le(t,37),Bc.fromName(e).path.forEach((e=>{this.le(t,60),this.Ie(e,t)}))}le(e,t){e.fe(t)}we(e){e.fe(2)}}Rl.Te=new Rl;class xl{constructor(){this.Ye=new Ol}addToCollectionParentIndex(e,t){return this.Ye.add(t),Gc.resolve()}getCollectionParents(e,t){return Gc.resolve(this.Ye.getEntries(t))}addFieldIndex(e,t){return Gc.resolve()}deleteFieldIndex(e,t){return Gc.resolve()}getDocumentsMatchingTarget(e,t){return Gc.resolve(null)}getIndexType(e,t){return Gc.resolve(0)}getFieldIndexes(e,t){return Gc.resolve([])}getNextCollectionGroupToUpdate(e){return Gc.resolve(null)}getMinOffset(e,t){return Gc.resolve(zc.min())}getMinOffsetFromCollectionGroup(e,t){return Gc.resolve(zc.min())}updateCollectionGroup(e,t,n){return Gc.resolve()}updateIndexEntries(e,t){return Gc.resolve()}}class Ol{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new tu(Fc.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new tu(Fc.comparator)).toArray()}}new Uint8Array(0);class Ll{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Ll(e,Ll.DEFAULT_COLLECTION_PERCENTILE,Ll.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Ll.DEFAULT_COLLECTION_PERCENTILE=10,Ll.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ll.DEFAULT=new Ll(41943040,Ll.DEFAULT_COLLECTION_PERCENTILE,Ll.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ll.DISABLED=new Ll(-1,0,0);class Pl{constructor(e){this.bn=e}next(){return this.bn+=2,this.bn}static Pn(){return new Pl(0)}static vn(){return new Pl(-1)}}class Ml{constructor(){this.changes=new Fh((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,xu.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Gc.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ul{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Fl{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.getBaseDocument(e,t,n)))).next((e=>(null!==n&&Ch(n.mutation,e,ru.empty(),Pc.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Wh()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=Wh()){const r=$h();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=qh();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=$h();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Wh())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=jh();const s=Hh(),o=Hh();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Nh)?i=i.insert(t.key,t):void 0!==o&&(s.set(t.key,o.mutation.getFieldMask()),Ch(o.mutation,t,o.mutation.getFieldMask(),Pc.now()))})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Ul(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Hh();let r=new Yc(((e,t)=>e-t)),i=Wh();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||ru.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Wh()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=Kh();c.forEach((e=>{if(!i.has(e)){const r=_h(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Gc.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n){return function(e){return Bc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):function(e){return null!==e.collectionGroup}(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Gc.resolve($h());let o=-1,a=i;return s.next((t=>Gc.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Gc.resolve():this.getBaseDocument(e,t,n).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Wh()))).next((e=>({batchId:o,changes:zh(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Bc(t)).next((e=>{let t=qh();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n){const r=t.collectionGroup;let i=qh();return this.indexManager.getCollectionParents(e,r).next((s=>Gc.forEach(s,(s=>{const o=function(e,t){return new Yu(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.getDocumentsMatchingCollectionQuery(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((i=>(r=i,this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)))).next((e=>{e.forEach(((e,t)=>{const n=t.getKey();null===r.get(n)&&(r=r.insert(n,xu.newInvalidDocument(n)))}));let n=qh();return r.forEach(((r,i)=>{const s=e.get(r);void 0!==s&&Ch(s.mutation,i,ru.empty(),Pc.now()),ah(t,i)&&(n=n.insert(r,i))})),n}))}getBaseDocument(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):Gc.resolve(xu.newInvalidDocument(t))}}class Vl{constructor(e){this.It=e,this.Zn=new Map,this.ts=new Map}getBundleMetadata(e,t){return Gc.resolve(this.Zn.get(t))}saveBundleMetadata(e,t){var n;return this.Zn.set(t.id,{id:(n=t).id,version:n.version,createTime:ul(n.createTime)}),Gc.resolve()}getNamedQuery(e,t){return Gc.resolve(this.ts.get(t))}saveNamedQuery(e,t){return this.ts.set(t.name,function(e){return{name:e.name,query:Dl(e.bundledQuery),readTime:ul(e.readTime)}}(t)),Gc.resolve()}}class jl{constructor(){this.overlays=new Yc(Bc.comparator),this.es=new Map}getOverlay(e,t){return Gc.resolve(this.overlays.get(t))}getOverlays(e,t){const n=$h();return Gc.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ue(e,t,r)})),Gc.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.es.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.es.delete(n)),Gc.resolve()}getOverlaysForCollection(e,t,n){const r=$h(),i=t.length+1,s=new Bc(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Gc.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Yc(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=$h(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=$h(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Gc.resolve(o)}ue(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.es.get(r.largestBatchId).delete(n.key);this.es.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new kl(t,n));let i=this.es.get(t);void 0===i&&(i=Wh(),this.es.set(t,i)),this.es.set(t,i.add(n.key))}}class Bl{constructor(){this.ns=new tu(ql.ss),this.rs=new tu(ql.os)}isEmpty(){return this.ns.isEmpty()}addReference(e,t){const n=new ql(e,t);this.ns=this.ns.add(n),this.rs=this.rs.add(n)}us(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.cs(new ql(e,t))}hs(e,t){e.forEach((e=>this.removeReference(e,t)))}ls(e){const t=new Bc(new Fc([])),n=new ql(t,e),r=new ql(t,e+1),i=[];return this.rs.forEachInRange([n,r],(e=>{this.cs(e),i.push(e.key)})),i}fs(){this.ns.forEach((e=>this.cs(e)))}cs(e){this.ns=this.ns.delete(e),this.rs=this.rs.delete(e)}ds(e){const t=new Bc(new Fc([])),n=new ql(t,e),r=new ql(t,e+1);let i=Wh();return this.rs.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new ql(e,0),n=this.ns.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class ql{constructor(e,t){this.key=e,this._s=t}static ss(e,t){return Bc.comparator(e.key,t.key)||Oc(e._s,t._s)}static os(e,t){return Oc(e._s,t._s)||Bc.comparator(e.key,t.key)}}class zl{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.ws=1,this.gs=new tu(ql.ss)}checkEmpty(e){return Gc.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.ws;this.ws++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new Cl(i,t,n,r);this.mutationQueue.push(s);for(const t of r)this.gs=this.gs.add(new ql(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return Gc.resolve(s)}lookupMutationBatch(e,t){return Gc.resolve(this.ys(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ps(n),i=r<0?0:r;return Gc.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Gc.resolve(0===this.mutationQueue.length?-1:this.ws-1)}getAllMutationBatches(e){return Gc.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new ql(t,0),r=new ql(t,Number.POSITIVE_INFINITY),i=[];return this.gs.forEachInRange([n,r],(e=>{const t=this.ys(e._s);i.push(t)})),Gc.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new tu(Oc);return t.forEach((e=>{const t=new ql(e,0),r=new ql(e,Number.POSITIVE_INFINITY);this.gs.forEachInRange([t,r],(e=>{n=n.add(e._s)}))})),Gc.resolve(this.Is(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Bc.isDocumentKey(i)||(i=i.child(""));const s=new ql(new Bc(i),0);let o=new tu(Oc);return this.gs.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e._s)),!0)}),s),Gc.resolve(this.Is(o))}Is(e){const t=[];return e.forEach((e=>{const n=this.ys(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){vc(0===this.Ts(t.batchId,"removed")),this.mutationQueue.shift();let n=this.gs;return Gc.forEach(t.mutations,(r=>{const i=new ql(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.gs=n}))}An(e){}containsKey(e,t){const n=new ql(t,0),r=this.gs.firstAfterOrEqual(n);return Gc.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Gc.resolve()}Ts(e,t){return this.ps(e)}ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}ys(e){const t=this.ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class $l{constructor(e){this.Es=e,this.docs=new Yc(Bc.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Es(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Gc.resolve(n?n.document.mutableCopy():xu.newInvalidDocument(t))}getEntries(e,t){let n=jh();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():xu.newInvalidDocument(e))})),Gc.resolve(n)}getAllFromCollection(e,t,n){let r=jh();const i=new Bc(t.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i}}=s.getNext();if(!t.isPrefixOf(e.path))break;e.path.length>t.length+1||$c(qc(i),n)<=0||(r=r.insert(i.key,i.mutableCopy()))}return Gc.resolve(r)}getAllFromCollectionGroup(e,t,n,r){yc()}As(e,t){return Gc.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new Kl(this)}getSize(e){return Gc.resolve(this.size)}}class Kl extends Ml{constructor(e){super(),this.Yn=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Yn.addEntry(e,r)):this.Yn.removeEntry(n)})),Gc.waitFor(t)}getFromCache(e,t){return this.Yn.getEntry(e,t)}getAllFromCache(e,t){return this.Yn.getEntries(e,t)}}class Hl{constructor(e){this.persistence=e,this.Rs=new Fh((e=>Pu(e)),Mu),this.lastRemoteSnapshotVersion=Mc.min(),this.highestTargetId=0,this.bs=0,this.Ps=new Bl,this.targetCount=0,this.vs=Pl.Pn()}forEachTarget(e,t){return this.Rs.forEach(((e,n)=>t(n))),Gc.resolve()}getLastRemoteSnapshotVersion(e){return Gc.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Gc.resolve(this.bs)}allocateTargetId(e){return this.highestTargetId=this.vs.next(),Gc.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.bs&&(this.bs=t),Gc.resolve()}Dn(e){this.Rs.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.vs=new Pl(t),this.highestTargetId=t),e.sequenceNumber>this.bs&&(this.bs=e.sequenceNumber)}addTargetData(e,t){return this.Dn(t),this.targetCount+=1,Gc.resolve()}updateTargetData(e,t){return this.Dn(t),Gc.resolve()}removeTargetData(e,t){return this.Rs.delete(t.target),this.Ps.ls(t.targetId),this.targetCount-=1,Gc.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Rs.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Rs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Gc.waitFor(i).next((()=>r))}getTargetCount(e){return Gc.resolve(this.targetCount)}getTargetData(e,t){const n=this.Rs.get(t)||null;return Gc.resolve(n)}addMatchingKeys(e,t,n){return this.Ps.us(t,n),Gc.resolve()}removeMatchingKeys(e,t,n){this.Ps.hs(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Gc.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ps.ls(t),Gc.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Ps.ds(t);return Gc.resolve(n)}containsKey(e,t){return Gc.resolve(this.Ps.containsKey(t))}}class Gl{constructor(e,t){this.Vs={},this.overlays={},this.Ss=new Qc(0),this.Ds=!1,this.Ds=!0,this.referenceDelegate=e(this),this.Cs=new Hl(this),this.indexManager=new xl,this.remoteDocumentCache=function(e){return new $l(e)}((e=>this.referenceDelegate.xs(e))),this.It=new Nl(t),this.Ns=new Vl(this.It)}start(){return Promise.resolve()}shutdown(){return this.Ds=!1,Promise.resolve()}get started(){return this.Ds}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new jl,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Vs[e.toKey()];return n||(n=new zl(t,this.referenceDelegate),this.Vs[e.toKey()]=n),n}getTargetCache(){return this.Cs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ns}runTransaction(e,t,n){fc("MemoryPersistence","Starting transaction:",e);const r=new Wl(this.Ss.next());return this.referenceDelegate.ks(),n(r).next((e=>this.referenceDelegate.Os(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ms(e,t){return Gc.or(Object.values(this.Vs).map((n=>()=>n.containsKey(e,t))))}}class Wl extends Kc{constructor(e){super(),this.currentSequenceNumber=e}}class Ql{constructor(e){this.persistence=e,this.Fs=new Bl,this.$s=null}static Bs(e){return new Ql(e)}get Ls(){if(this.$s)return this.$s;throw yc()}addReference(e,t,n){return this.Fs.addReference(n,t),this.Ls.delete(n.toString()),Gc.resolve()}removeReference(e,t,n){return this.Fs.removeReference(n,t),this.Ls.add(n.toString()),Gc.resolve()}markPotentiallyOrphaned(e,t){return this.Ls.add(t.toString()),Gc.resolve()}removeTarget(e,t){this.Fs.ls(t.targetId).forEach((e=>this.Ls.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Ls.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}ks(){this.$s=new Set}Os(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Gc.forEach(this.Ls,(n=>{const r=Bc.fromPath(n);return this.Us(e,r).next((e=>{e||t.removeEntry(r,Mc.min())}))})).next((()=>(this.$s=null,t.apply(e))))}updateLimboDocument(e,t){return this.Us(e,t).next((e=>{e?this.Ls.delete(t.toString()):this.Ls.add(t.toString())}))}xs(e){return 0}Us(e,t){return Gc.or([()=>Gc.resolve(this.Fs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ms(e,t)])}}class Xl{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Si=n,this.Di=r}static Ci(e,t){let n=Wh(),r=Wh();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new Xl(e,t.fromCache,n,r)}}class Jl{constructor(){this.xi=!1}initialize(e,t){this.Ni=e,this.indexManager=t,this.xi=!0}getDocumentsMatchingQuery(e,t,n,r){return this.ki(e,t).next((i=>i||this.Oi(e,t,r,n))).next((n=>n||this.Mi(e,t)))}ki(e,t){if(eh(t))return Gc.resolve(null);let n=nh(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=rh(t,null,"F"),n=nh(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Wh(...r);return this.Ni.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Fi(t,r);return this.$i(t,s,i,n.readTime)?this.ki(e,rh(t,null,"F")):this.Bi(e,s,t,n)}))))})))))}Oi(e,t,n,r){return eh(t)||r.isEqual(Mc.min())?this.Mi(e,t):this.Ni.getDocuments(e,n).next((i=>{const s=this.Fi(t,i);return this.$i(t,s,n,r)?this.Mi(e,t):(dc()<=D.DEBUG&&fc("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),oh(t)),this.Bi(e,s,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Mc.fromTimestamp(1e9===r?new Pc(n+1,0):new Pc(n,r));return new zc(i,Bc.empty(),t)}(r,-1)))}))}Fi(e,t){let n=new tu(ch(e));return t.forEach(((t,r)=>{ah(e,r)&&(n=n.add(r))})),n}$i(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Mi(e,t){return dc()<=D.DEBUG&&fc("QueryEngine","Using full collection scan to execute query:",oh(t)),this.Ni.getDocumentsMatchingQuery(e,t,zc.min())}Bi(e,t,n,r){return this.Ni.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class Yl{constructor(e,t,n,r){this.persistence=e,this.Li=t,this.It=r,this.Ui=new Yc(Oc),this.qi=new Fh((e=>Pu(e)),Mu),this.Ki=new Map,this.Gi=e.getRemoteDocumentCache(),this.Cs=e.getTargetCache(),this.Ns=e.getBundleCache(),this.Qi(n)}Qi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Fl(this.Gi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Gi.setIndexManager(this.indexManager),this.Li.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ui)))}}async function Zl(e,t){const n=wc(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Qi(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Wh();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({ji:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function ed(e){const t=wc(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Cs.getLastRemoteSnapshotVersion(e)))}async function td(e,t,n){const r=wc(e),i=r.Ui.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Wc(e))throw e;fc("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ui=r.Ui.remove(t),r.qi.delete(i.target)}function nd(e,t,n){const r=wc(e);let i=Mc.min(),s=Wh();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=wc(e),i=r.qi.get(n);return void 0!==i?Gc.resolve(r.Ui.get(i)):r.Cs.getTargetData(t,n)}(r,e,nh(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Cs.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Li.getDocumentsMatchingQuery(e,t,n?i:Mc.min(),n?s:Wh()))).next((e=>(function(e,t,n){let r=e.Ki.get(t)||Mc.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Ki.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Hi:s})))))}class rd{constructor(){this.activeTargetIds=Xh()}er(e){this.activeTargetIds=this.activeTargetIds.add(e)}nr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}tr(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class id{constructor(){this.Lr=new rd,this.Ur={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Lr.er(e),this.Ur[e]||"not-current"}updateQueryState(e,t,n){this.Ur[e]=t}removeLocalQueryTarget(e){this.Lr.nr(e)}isLocalQueryTarget(e){return this.Lr.activeTargetIds.has(e)}clearQueryState(e){delete this.Ur[e]}getAllActiveQueryTargets(){return this.Lr.activeTargetIds}isActiveQueryTarget(e){return this.Lr.activeTargetIds.has(e)}start(){return this.Lr=new rd,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class sd{qr(e){}shutdown(){}}class od{constructor(){this.Kr=()=>this.Gr(),this.Qr=()=>this.jr(),this.Wr=[],this.zr()}qr(e){this.Wr.push(e)}shutdown(){window.removeEventListener("online",this.Kr),window.removeEventListener("offline",this.Qr)}zr(){window.addEventListener("online",this.Kr),window.addEventListener("offline",this.Qr)}Gr(){fc("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.Wr)e(0)}jr(){fc("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.Wr)e(1)}static C(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const ad={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class cd{constructor(e){this.Hr=e.Hr,this.Jr=e.Jr}Yr(e){this.Xr=e}Zr(e){this.eo=e}onMessage(e){this.no=e}close(){this.Jr()}send(e){this.Hr(e)}so(){this.Xr()}io(e){this.eo(e)}ro(e){this.no(e)}}class ud extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.oo=t+"://"+e.host,this.uo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get co(){return!1}ao(e,t,n,r,i){const s=this.ho(e,t);fc("RestConnection","Sending: ",s,n);const o={};return this.lo(o,r,i),this.fo(e,s,o,n).then((e=>(fc("RestConnection","Received: ",e),e)),(t=>{throw gc("RestConnection",`${e} failed with error: `,t,"url: ",s,"request:",n),t}))}_o(e,t,n,r,i,s){return this.ao(e,t,n,r,i)}lo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+hc,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}ho(e,t){const n=ad[e];return`${this.oo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}fo(e,t,n,r){return new Promise(((i,s)=>{const o=new ac;o.setWithCredentials(!0),o.listenOnce(nc.COMPLETE,(()=>{var t;try{switch(o.getLastErrorCode()){case tc.NO_ERROR:const n=o.getResponseJson();fc("Connection","XHR received:",JSON.stringify(n)),i(n);break;case tc.TIMEOUT:fc("Connection",'RPC "'+e+'" timed out'),s(new Ic(bc.DEADLINE_EXCEEDED,"Request time out"));break;case tc.HTTP_ERROR:const r=o.getStatus();if(fc("Connection",'RPC "'+e+'" failed with status:',r,"response text:",o.getResponseText()),r>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const n=null===(t=e)||void 0===t?void 0:t.error;if(n&&n.status&&n.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(bc).indexOf(t)>=0?t:bc.UNKNOWN}(n.status);s(new Ic(e,n.message))}else s(new Ic(bc.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Ic(bc.UNAVAILABLE,"Connection failed."));break;default:yc()}}finally{fc("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}wo(e,t,n){const r=[this.oo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Za(),s=ec(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new sc({})),this.lo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const a=r.join("");fc("Connection","Creating WebChannel: "+a,o);const c=i.createWebChannel(a,o);let u=!1,h=!1;const l=new cd({Hr:e=>{h?fc("Connection","Not sending because WebChannel is closed:",e):(u||(fc("Connection","Opening WebChannel transport."),c.open(),u=!0),fc("Connection","WebChannel sending:",e),c.send(e))},Jr:()=>c.close()}),d=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return d(c,oc.EventType.OPEN,(()=>{h||fc("Connection","WebChannel transport opened.")})),d(c,oc.EventType.CLOSE,(()=>{h||(h=!0,fc("Connection","WebChannel transport closed"),l.io())})),d(c,oc.EventType.ERROR,(e=>{h||(h=!0,gc("Connection","WebChannel transport errored:",e),l.io(new Ic(bc.UNAVAILABLE,"The operation could not be completed")))})),d(c,oc.EventType.MESSAGE,(e=>{var t;if(!h){const n=e.data[0];vc(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){fc("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=Ph[e];if(void 0!==t)return Uh(t)}(e),n=i.message;void 0===t&&(t=bc.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),h=!0,l.io(new Ic(t,n)),c.close()}else fc("Connection","WebChannel received:",n),l.ro(n)}})),d(s,rc.STAT_EVENT,(e=>{e.stat===ic.PROXY?fc("Connection","Detected buffering proxy"):e.stat===ic.NOPROXY&&fc("Connection","Detected no buffering proxy")})),setTimeout((()=>{l.so()}),0),l}}function hd(){return"undefined"!=typeof document?document:null}function ld(e){return new cl(e,!0)}class dd{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Hs=e,this.timerId=t,this.mo=n,this.yo=r,this.po=i,this.Io=0,this.To=null,this.Eo=Date.now(),this.reset()}reset(){this.Io=0}Ao(){this.Io=this.po}Ro(e){this.cancel();const t=Math.floor(this.Io+this.bo()),n=Math.max(0,Date.now()-this.Eo),r=Math.max(0,t-n);r>0&&fc("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Io} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.To=this.Hs.enqueueAfterDelay(this.timerId,r,(()=>(this.Eo=Date.now(),e()))),this.Io*=this.yo,this.Io<this.mo&&(this.Io=this.mo),this.Io>this.po&&(this.Io=this.po)}Po(){null!==this.To&&(this.To.skipDelay(),this.To=null)}cancel(){null!==this.To&&(this.To.cancel(),this.To=null)}bo(){return(Math.random()-.5)*this.Io}}class fd{constructor(e,t,n,r,i,s,o,a){this.Hs=e,this.vo=n,this.Vo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.So=0,this.Do=null,this.Co=null,this.stream=null,this.xo=new dd(e,t)}No(){return 1===this.state||5===this.state||this.ko()}ko(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Oo()}async stop(){this.No()&&await this.close(0)}Mo(){this.state=0,this.xo.reset()}Fo(){this.ko()&&null===this.Do&&(this.Do=this.Hs.enqueueAfterDelay(this.vo,6e4,(()=>this.$o())))}Bo(e){this.Lo(),this.stream.send(e)}async $o(){if(this.ko())return this.close(0)}Lo(){this.Do&&(this.Do.cancel(),this.Do=null)}Uo(){this.Co&&(this.Co.cancel(),this.Co=null)}async close(e,t){this.Lo(),this.Uo(),this.xo.cancel(),this.So++,4!==e?this.xo.reset():t&&t.code===bc.RESOURCE_EXHAUSTED?(pc(t.toString()),pc("Using maximum backoff delay to prevent overloading the backend."),this.xo.Ao()):t&&t.code===bc.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.qo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Zr(t)}qo(){}auth(){this.state=1;const e=this.Ko(this.So),t=this.So;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.So===t&&this.Go(e,n)}),(t=>{e((()=>{const e=new Ic(bc.UNKNOWN,"Fetching auth token failed: "+t.message);return this.Qo(e)}))}))}Go(e,t){const n=this.Ko(this.So);this.stream=this.jo(e,t),this.stream.Yr((()=>{n((()=>(this.state=2,this.Co=this.Hs.enqueueAfterDelay(this.Vo,1e4,(()=>(this.ko()&&(this.state=3),Promise.resolve()))),this.listener.Yr())))})),this.stream.Zr((e=>{n((()=>this.Qo(e)))})),this.stream.onMessage((e=>{n((()=>this.onMessage(e)))}))}Oo(){this.state=5,this.xo.Ro((async()=>{this.state=0,this.start()}))}Qo(e){return fc("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Ko(e){return t=>{this.Hs.enqueueAndForget((()=>this.So===e?t():(fc("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class pd extends fd{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.It=i}jo(e,t){return this.connection.wo("Listen",e,t)}onMessage(e){this.xo.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:yc()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.gt?(vc(void 0===t||"string"==typeof t),iu.fromBase64String(t||"")):(vc(void 0===t||t instanceof Uint8Array),iu.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?bc.UNKNOWN:Uh(e.code);return new Ic(t,e.message||"")}(o);n=new tl(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=ll(e,r.document.name),s=ul(r.document.updateTime),o=new Ru({mapValue:{fields:r.document.fields}}),a=xu.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Zh(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=ll(e,r.document),s=r.readTime?ul(r.readTime):Mc.min(),o=xu.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Zh([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=ll(e,r.document),s=r.removedTargetIds||[];n=new Zh([],s,i,null)}else{if(!("filter"in t))return yc();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new Lh(r),s=e.targetId;n=new el(s,i)}}return n}(this.It,e),n=function(e){if(!("targetChange"in e))return Mc.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Mc.min():t.readTime?ul(t.readTime):Mc.min()}(e);return this.listener.Wo(t,n)}zo(e){const t={};t.database=fl(this.It),t.addTarget=function(e,t){let n;const r=t.target;return n=Uu(r)?{documents:gl(e,r)}:{query:ml(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=function(e,t){return e.gt?t.toBase64():t.toUint8Array()}(e,t.resumeToken):t.snapshotVersion.compareTo(Mc.min())>0&&(n.readTime=function(e,t){return e.gt?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}(e,t.snapshotVersion.toTimestamp())),n}(this.It,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return yc()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.It,e);n&&(t.labels=n),this.Bo(t)}Ho(e){const t={};t.database=fl(this.It),t.removeTarget=e,this.Bo(t)}}class gd extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.It=r,this.nu=!1}su(){if(this.nu)throw new Ic(bc.FAILED_PRECONDITION,"The client has already been terminated.")}ao(e,t,n){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([r,i])=>this.connection.ao(e,t,n,r,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===bc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ic(bc.UNKNOWN,e.toString())}))}_o(e,t,n,r){return this.su(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection._o(e,t,n,i,s,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===bc.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new Ic(bc.UNKNOWN,e.toString())}))}terminate(){this.nu=!0}}class md{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.iu=0,this.ru=null,this.ou=!0}uu(){0===this.iu&&(this.cu("Unknown"),this.ru=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.ru=null,this.au("Backend didn't respond within 10 seconds."),this.cu("Offline"),Promise.resolve()))))}hu(e){"Online"===this.state?this.cu("Unknown"):(this.iu++,this.iu>=1&&(this.lu(),this.au(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.cu("Offline")))}set(e){this.lu(),this.iu=0,"Online"===e&&(this.ou=!1),this.cu(e)}cu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}au(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ou?(pc(t),this.ou=!1):fc("OnlineStateTracker",t)}lu(){null!==this.ru&&(this.ru.cancel(),this.ru=null)}}class yd{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.fu=[],this.du=new Map,this._u=new Set,this.wu=[],this.mu=i,this.mu.qr((e=>{n.enqueueAndForget((async()=>{Cd(this)&&(fc("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=wc(e);t._u.add(4),await wd(t),t.gu.set("Unknown"),t._u.delete(4),await vd(t)}(this))}))})),this.gu=new md(n,r)}}async function vd(e){if(Cd(e))for(const t of e.wu)await t(!0)}async function wd(e){for(const t of e.wu)await t(!1)}function bd(e,t){const n=wc(e);n.du.has(t.targetId)||(n.du.set(t.targetId,t),Sd(n)?_d(n):Od(n).ko()&&Td(n,t))}function Id(e,t){const n=wc(e),r=Od(n);n.du.delete(t),r.ko()&&Ed(n,t),0===n.du.size&&(r.ko()?r.Fo():Cd(n)&&n.gu.set("Unknown"))}function Td(e,t){e.yu.Mt(t.targetId),Od(e).zo(t)}function Ed(e,t){e.yu.Mt(t),Od(e).Ho(t)}function _d(e){e.yu=new rl({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),se:t=>e.du.get(t)||null}),Od(e).start(),e.gu.uu()}function Sd(e){return Cd(e)&&!Od(e).No()&&e.du.size>0}function Cd(e){return 0===wc(e)._u.size}function kd(e){e.yu=void 0}async function Ad(e){e.du.forEach(((t,n)=>{Td(e,t)}))}async function Nd(e,t){kd(e),Sd(e)?(e.gu.hu(t),_d(e)):e.gu.set("Unknown")}async function Dd(e,t,n){if(e.gu.set("Online"),t instanceof tl&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.du.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.du.delete(r),e.yu.removeTarget(r))}(e,t)}catch(n){fc("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Rd(e,n)}else if(t instanceof Zh?e.yu.Gt(t):t instanceof el?e.yu.Yt(t):e.yu.Wt(t),!n.isEqual(Mc.min()))try{const t=await ed(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.yu.te(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.du.get(r);i&&e.du.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.du.get(t);if(!n)return;e.du.set(t,n.withResumeToken(iu.EMPTY_BYTE_STRING,n.snapshotVersion)),Ed(e,t);const r=new Al(n.target,t,1,n.sequenceNumber);Td(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){fc("RemoteStore","Failed to raise snapshot:",t),await Rd(e,t)}}async function Rd(e,t,n){if(!Wc(t))throw t;e._u.add(1),await wd(e),e.gu.set("Offline"),n||(n=()=>ed(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{fc("RemoteStore","Retrying IndexedDB access"),await n(),e._u.delete(1),await vd(e)}))}async function xd(e,t){const n=wc(e);n.asyncQueue.verifyOperationInProgress(),fc("RemoteStore","RemoteStore received new credentials");const r=Cd(n);n._u.add(3),await wd(n),r&&n.gu.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n._u.delete(3),await vd(n)}function Od(e){return e.pu||(e.pu=function(e,t,n){const r=wc(e);return r.su(),new pd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.It,n)}(e.datastore,e.asyncQueue,{Yr:Ad.bind(null,e),Zr:Nd.bind(null,e),Wo:Dd.bind(null,e)}),e.wu.push((async t=>{t?(e.pu.Mo(),Sd(e)?_d(e):e.gu.set("Unknown")):(await e.pu.stop(),kd(e))}))),e.pu}class Ld{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Tc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Ld(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Ic(bc.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Pd(e,t){if(pc("AsyncQueue",`${t}: ${e}`),Wc(e))return new Ic(bc.UNAVAILABLE,`${t}: ${e}`);throw e}class Md{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Bc.comparator(t.key,n.key):(e,t)=>Bc.comparator(e.key,t.key),this.keyedMap=qh(),this.sortedSet=new Yc(this.comparator)}static emptySet(e){return new Md(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Md))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Md;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Ud{constructor(){this.Tu=new Yc(Bc.comparator)}track(e){const t=e.doc.key,n=this.Tu.get(t);n?0!==e.type&&3===n.type?this.Tu=this.Tu.insert(t,e):3===e.type&&1!==n.type?this.Tu=this.Tu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Tu=this.Tu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Tu=this.Tu.remove(t):1===e.type&&2===n.type?this.Tu=this.Tu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Tu=this.Tu.insert(t,{type:2,doc:e.doc}):yc():this.Tu=this.Tu.insert(t,e)}Eu(){const e=[];return this.Tu.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Fd{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Fd(e,t,Md.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ih(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class Vd{constructor(){this.Au=void 0,this.listeners=[]}}class jd{constructor(){this.queries=new Fh((e=>sh(e)),ih),this.onlineState="Unknown",this.Ru=new Set}}async function Bd(e,t){const n=wc(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new Vd),i)try{s.Au=await n.onListen(r)}catch(e){const n=Pd(e,`Initialization of query '${oh(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.bu(n.onlineState),s.Au&&t.Pu(s.Au)&&Kd(n)}async function qd(e,t){const n=wc(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function zd(e,t){const n=wc(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.Pu(e)&&(r=!0);i.Au=e}}r&&Kd(n)}function $d(e,t,n){const r=wc(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function Kd(e){e.Ru.forEach((e=>{e.next()}))}class Hd{constructor(e,t,n){this.query=e,this.vu=t,this.Vu=!1,this.Su=null,this.onlineState="Unknown",this.options=n||{}}Pu(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Fd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Vu?this.Du(e)&&(this.vu.next(e),t=!0):this.Cu(e,this.onlineState)&&(this.xu(e),t=!0),this.Su=e,t}onError(e){this.vu.error(e)}bu(e){this.onlineState=e;let t=!1;return this.Su&&!this.Vu&&this.Cu(this.Su,e)&&(this.xu(this.Su),t=!0),t}Cu(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return(!this.options.Nu||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Du(e){if(e.docChanges.length>0)return!0;const t=this.Su&&this.Su.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}xu(e){e=Fd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Vu=!0,this.vu.next(e)}}class Gd{constructor(e){this.key=e}}class Wd{constructor(e){this.key=e}}class Qd{constructor(e,t){this.query=e,this.Uu=t,this.qu=null,this.hasCachedResults=!1,this.current=!1,this.Ku=Wh(),this.mutatedKeys=Wh(),this.Gu=ch(e),this.Qu=new Md(this.Gu)}get ju(){return this.Uu}Wu(e,t){const n=t?t.zu:new Ud,r=t?t.Qu:this.Qu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),h=ah(this.query,t)?t:null,l=!!u&&this.mutatedKeys.has(u.key),d=!!h&&(h.hasLocalMutations||this.mutatedKeys.has(h.key)&&h.hasCommittedMutations);let f=!1;u&&h?u.data.isEqual(h.data)?l!==d&&(n.track({type:3,doc:h}),f=!0):this.Hu(u,h)||(n.track({type:2,doc:h}),f=!0,(a&&this.Gu(h,a)>0||c&&this.Gu(h,c)<0)&&(o=!0)):!u&&h?(n.track({type:0,doc:h}),f=!0):u&&!h&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(h?(s=s.add(h),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Qu:s,zu:n,$i:o,mutatedKeys:i}}Hu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Qu;this.Qu=e.Qu,this.mutatedKeys=e.mutatedKeys;const i=e.zu.Eu();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return yc()}};return n(e)-n(t)}(e.type,t.type)||this.Gu(e.doc,t.doc))),this.Ju(n);const s=t?this.Yu():[],o=0===this.Ku.size&&this.current?1:0,a=o!==this.qu;return this.qu=o,0!==i.length||a?{snapshot:new Fd(this.query,e.Qu,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),Xu:s}:{Xu:s}}bu(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Qu:this.Qu,zu:new Ud,mutatedKeys:this.mutatedKeys,$i:!1},!1)):{Xu:[]}}Zu(e){return!this.Uu.has(e)&&!!this.Qu.has(e)&&!this.Qu.get(e).hasLocalMutations}Ju(e){e&&(e.addedDocuments.forEach((e=>this.Uu=this.Uu.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Uu=this.Uu.delete(e))),this.current=e.current)}Yu(){if(!this.current)return[];const e=this.Ku;this.Ku=Wh(),this.Qu.forEach((e=>{this.Zu(e.key)&&(this.Ku=this.Ku.add(e.key))}));const t=[];return e.forEach((e=>{this.Ku.has(e)||t.push(new Wd(e))})),this.Ku.forEach((n=>{e.has(n)||t.push(new Gd(n))})),t}tc(e){this.Uu=e.Hi,this.Ku=Wh();const t=this.Wu(e.documents);return this.applyChanges(t,!0)}ec(){return Fd.fromInitialDocuments(this.query,this.Qu,this.mutatedKeys,0===this.qu,this.hasCachedResults)}}class Xd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Jd{constructor(e){this.key=e,this.nc=!1}}class Yd{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.sc={},this.ic=new Fh((e=>sh(e)),ih),this.rc=new Map,this.oc=new Set,this.uc=new Yc(Bc.comparator),this.cc=new Map,this.ac=new Bl,this.hc={},this.lc=new Map,this.fc=Pl.vn(),this.onlineState="Unknown",this.dc=void 0}get isPrimaryClient(){return!0===this.dc}}async function Zd(e,t){const n=function(e){const t=wc(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=tf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=df.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=rf.bind(null,t),t.sc.Wo=zd.bind(null,t.eventManager),t.sc.wc=$d.bind(null,t.eventManager),t}(e);let r,i;const s=n.ic.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.ec();else{const e=await function(e,t){const n=wc(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Cs.getTargetData(e,t).next((i=>i?(r=i,Gc.resolve(r)):n.Cs.allocateTargetId(e).next((i=>(r=new Al(t,i,0,e.currentSequenceNumber),n.Cs.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ui.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ui=n.Ui.insert(e.targetId,e),n.qi.set(t,e.targetId)),e}))}(n.localStore,nh(t));n.isPrimaryClient&&bd(n.remoteStore,e);const s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await async function(e,t,n,r,i){e._c=(t,n,r)=>async function(e,t,n,r){let i=t.view.Wu(n);i.$i&&(i=await nd(e.localStore,t.query,!1).then((({documents:e})=>t.view.Wu(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return af(e,t.targetId,o.Xu),o.snapshot}(e,t,n,r);const s=await nd(e.localStore,t,!0),o=new Qd(t,s.Hi),a=o.Wu(s.documents),c=Yh.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);af(e,n,u.Xu);const h=new Xd(t,n,o);return e.ic.set(t,h),e.rc.has(n)?e.rc.get(n).push(t):e.rc.set(n,[t]),u.snapshot}(n,t,r,"current"===s,e.resumeToken)}return i}async function ef(e,t){const n=wc(e),r=n.ic.get(t),i=n.rc.get(r.targetId);if(i.length>1)return n.rc.set(r.targetId,i.filter((e=>!ih(e,t)))),void n.ic.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await td(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),Id(n.remoteStore,r.targetId),sf(n,r.targetId)})).catch(Hc)):(sf(n,r.targetId),await td(n.localStore,r.targetId,!0))}async function tf(e,t){const n=wc(e);try{const e=await function(e,t){const n=wc(e),r=t.snapshotVersion;let i=n.Ui;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Gi.newChangeBuffer({trackRemovals:!0});i=n.Ui;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Cs.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Cs.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(a)?u=u.withResumeToken(iu.EMPTY_BYTE_STRING,Mc.min()).withLastLimboFreeSnapshotVersion(Mc.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,u,s)&&o.push(n.Cs.updateTargetData(e,u))}));let a=jh(),c=Wh();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(function(e,t,n){let r=Wh(),i=Wh();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=jh();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Mc.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):fc("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Wi:r,zi:i}}))}(e,s,t.documentUpdates).next((e=>{a=e.Wi,c=e.zi}))),!r.isEqual(Mc.min())){const t=n.Cs.getLastRemoteSnapshotVersion(e).next((t=>n.Cs.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Gc.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.Ui=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.cc.get(t);r&&(vc(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.nc=!0:e.modifiedDocuments.size>0?vc(r.nc):e.removedDocuments.size>0&&(vc(r.nc),r.nc=!1))})),await hf(n,e,t)}catch(e){await Hc(e)}}function nf(e,t,n){const r=wc(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.ic.forEach(((n,r)=>{const i=r.view.bu(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=wc(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.bu(t)&&(r=!0)})),r&&Kd(n)}(r.eventManager,t),e.length&&r.sc.Wo(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function rf(e,t,n){const r=wc(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.cc.get(t),s=i&&i.key;if(s){let e=new Yc(Bc.comparator);e=e.insert(s,xu.newNoDocument(s,Mc.min()));const n=Wh().add(s),i=new Jh(Mc.min(),new Map,new tu(Oc),e,n);await tf(r,i),r.uc=r.uc.remove(s),r.cc.delete(t),uf(r)}else await td(r.localStore,t,!1).then((()=>sf(r,t,n))).catch(Hc)}function sf(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.rc.get(t))e.ic.delete(r),n&&e.sc.wc(r,n);e.rc.delete(t),e.isPrimaryClient&&e.ac.ls(t).forEach((t=>{e.ac.containsKey(t)||of(e,t)}))}function of(e,t){e.oc.delete(t.path.canonicalString());const n=e.uc.get(t);null!==n&&(Id(e.remoteStore,n),e.uc=e.uc.remove(t),e.cc.delete(n),uf(e))}function af(e,t,n){for(const r of n)r instanceof Gd?(e.ac.addReference(r.key,t),cf(e,r)):r instanceof Wd?(fc("SyncEngine","Document no longer in limbo: "+r.key),e.ac.removeReference(r.key,t),e.ac.containsKey(r.key)||of(e,r.key)):yc()}function cf(e,t){const n=t.key,r=n.path.canonicalString();e.uc.get(n)||e.oc.has(r)||(fc("SyncEngine","New document in limbo: "+n),e.oc.add(r),uf(e))}function uf(e){for(;e.oc.size>0&&e.uc.size<e.maxConcurrentLimboResolutions;){const t=e.oc.values().next().value;e.oc.delete(t);const n=new Bc(Fc.fromString(t)),r=e.fc.next();e.cc.set(r,new Jd(n)),e.uc=e.uc.insert(n,r),bd(e.remoteStore,new Al(nh(Zu(n.path)),r,2,Qc.at))}}async function hf(e,t,n){const r=wc(e),i=[],s=[],o=[];r.ic.isEmpty()||(r.ic.forEach(((e,a)=>{o.push(r._c(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,(null==e?void 0:e.fromCache)?"not-current":"current"),e){i.push(e);const t=Xl.Ci(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.sc.Wo(i),await async function(e,t){const n=wc(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Gc.forEach(t,(t=>Gc.forEach(t.Si,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Gc.forEach(t.Di,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Wc(e))throw e;fc("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Ui.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Ui=n.Ui.insert(t,i)}}}(r.localStore,s))}async function lf(e,t){const n=wc(e);if(!n.currentUser.isEqual(t)){fc("SyncEngine","User change. New user:",t.toKey());const e=await Zl(n.localStore,t);n.currentUser=t,function(e,t){e.lc.forEach((e=>{e.forEach((e=>{e.reject(new Ic(bc.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.lc.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await hf(n,e.ji)}}function df(e,t){const n=wc(e),r=n.cc.get(t);if(r&&r.nc)return Wh().add(r.key);{let e=Wh();const r=n.rc.get(t);if(!r)return e;for(const t of r){const r=n.ic.get(t);e=e.unionWith(r.view.ju)}return e}}class ff{constructor(){this.synchronizeTabs=!1}async initialize(e){this.It=ld(e.databaseInfo.databaseId),this.sharedClientState=this.gc(e),this.persistence=this.yc(e),await this.persistence.start(),this.localStore=this.Ic(e),this.gcScheduler=this.Tc(e,this.localStore),this.indexBackfillerScheduler=this.Ec(e,this.localStore)}Tc(e,t){return null}Ec(e,t){return null}Ic(e){return function(e,t,n,r){return new Yl(e,t,n,r)}(this.persistence,new Jl,e.initialUser,this.It)}yc(e){return new Gl(Ql.Bs,this.It)}gc(e){return new id}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class pf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>nf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=lf.bind(null,this.syncEngine),await async function(e,t){const n=wc(e);t?(n._u.delete(2),await vd(n)):t||(n._u.add(2),await wd(n),n.gu.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new jd}createDatastore(e){const t=ld(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new ud(r));var r;return function(e,t,n,r){return new gd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>nf(this.syncEngine,e,0),s=od.C()?new od:new sd,new yd(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Yd(e,t,n,r,i,s);return o&&(a.dc=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=wc(e);fc("RemoteStore","RemoteStore shutting down."),t._u.add(5),await wd(t),t.mu.shutdown(),t.gu.set("Unknown")}(this.remoteStore)}}function gf(e,t,n){if(!n)throw new Ic(bc.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function mf(e){if(!Bc.isDocumentKey(e))throw new Ic(bc.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function yf(e){if(Bc.isDocumentKey(e))throw new Ic(bc.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function vf(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Ic(bc.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=function(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":yc()}(e);throw new Ic(bc.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}const wf=new Map;class bf{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Ic(bc.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Ic(bc.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Ic(bc.INVALID_ARGUMENT,"experimentalForceLongPolling and experimentalAutoDetectLongPolling cannot be used together.")}(0,e.experimentalForceLongPolling,0,e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class If{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new bf({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new Ic(bc.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Ic(bc.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new bf(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new _c;switch(e.type){case"gapi":const t=e.client;return new Ac(t,e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new Ic(bc.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=wf.get(e);t&&(fc("ComponentProvider","Removing Datastore"),wf.delete(e),t.terminate())}(this),Promise.resolve()}}class Tf{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new _f(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tf(this.firestore,e,this._key)}}class Ef{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ef(this.firestore,e,this._query)}}class _f extends Ef{constructor(e,t,n){super(e,t,Zu(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tf(this.firestore,null,new Bc(e))}withConverter(e){return new _f(this.firestore,e,this._path)}}function Sf(e,t,...n){if(e=_(e),1===arguments.length&&(t=xc.R()),gf("doc","path",t),e instanceof If){const r=Fc.fromString(t,...n);return mf(r),new Tf(e,null,new Bc(r))}{if(!(e instanceof Tf||e instanceof _f))throw new Ic(bc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Fc.fromString(t,...n));return mf(r),new Tf(e.firestore,e instanceof _f?e.converter:null,new Bc(r))}}class Cf{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Rc(this.observer.next,e)}error(e){this.observer.error?this.Rc(this.observer.error,e):pc("Uncaught Error in snapshot listener:",e.toString())}bc(){this.muted=!0}Rc(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class kf{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=uc.UNAUTHENTICATED,this.clientId=xc.R(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,(async e=>{fc("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(fc("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Ic(bc.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Tc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Pd(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Af(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){return e.offlineComponents||(fc("FirestoreClient","Using default OfflineComponentProvider"),await async function(e,t){e.asyncQueue.verifyOperationInProgress(),fc("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Zl(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}(e,new ff)),e.offlineComponents}(e);fc("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>xd(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>xd(t.remoteStore,n))),e.onlineComponents=t}async function Nf(e){const t=await async function(e){return e.onlineComponents||(fc("FirestoreClient","Using default OnlineComponentProvider"),await Af(e,new pf)),e.onlineComponents}(e),n=t.eventManager;return n.onListen=Zd.bind(null,t.syncEngine),n.onUnlisten=ef.bind(null,t.syncEngine),n}class Df{constructor(){this.Bc=Promise.resolve(),this.Lc=[],this.Uc=!1,this.qc=[],this.Kc=null,this.Gc=!1,this.Qc=!1,this.jc=[],this.xo=new dd(this,"async_queue_retry"),this.Wc=()=>{const e=hd();e&&fc("AsyncQueue","Visibility state changed to "+e.visibilityState),this.xo.Po()};const e=hd();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Wc)}get isShuttingDown(){return this.Uc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.zc(),this.Hc(e)}enterRestrictedMode(e){if(!this.Uc){this.Uc=!0,this.Qc=e||!1;const t=hd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Wc)}}enqueue(e){if(this.zc(),this.Uc)return new Promise((()=>{}));const t=new Tc;return this.Hc((()=>this.Uc&&this.Qc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Lc.push(e),this.Jc())))}async Jc(){if(0!==this.Lc.length){try{await this.Lc[0](),this.Lc.shift(),this.xo.reset()}catch(e){if(!Wc(e))throw e;fc("AsyncQueue","Operation failed with retryable error: "+e)}this.Lc.length>0&&this.xo.Ro((()=>this.Jc()))}}Hc(e){const t=this.Bc.then((()=>(this.Gc=!0,e().catch((e=>{this.Kc=e,this.Gc=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw pc("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.Gc=!1,e))))));return this.Bc=t,t}enqueueAfterDelay(e,t,n){this.zc(),this.jc.indexOf(e)>-1&&(t=0);const r=Ld.createAndSchedule(this,e,t,n,(e=>this.Yc(e)));return this.qc.push(r),r}zc(){this.Kc&&yc()}verifyOperationInProgress(){}async Xc(){let e;do{e=this.Bc,await e}while(e!==this.Bc)}Zc(e){for(const t of this.qc)if(t.timerId===e)return!0;return!1}ta(e){return this.Xc().then((()=>{this.qc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.qc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Xc()}))}ea(e){this.jc.push(e)}Yc(e){const t=this.qc.indexOf(e);this.qc.splice(t,1)}}class Rf extends If{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Df,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||Of(this),this._firestoreClient.terminate()}}function xf(e){return e._firestoreClient||Of(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Of(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new du(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new kf(e._authCredentials,e._appCheckCredentials,e._queue,r)}class Lf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Lf(iu.fromBase64String(e))}catch(e){throw new Ic(bc.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Lf(iu.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Pf{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Ic(bc.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Mf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ic(bc.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ic(bc.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Oc(this._lat,e._lat)||Oc(this._long,e._long)}}const Uf=new RegExp("[~\\*/\\[\\]]");function Ff(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Ic(bc.INVALID_ARGUMENT,a+e+c)}class Vf{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Tf(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new jf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Bf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class jf extends Vf{data(){return super.data()}}function Bf(e,t){return"string"==typeof t?function(e,t,n){if(t.search(Uf)>=0)throw Ff(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Pf(...t.split("."))._internalPath}catch(r){throw Ff(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}(e,t):t instanceof Pf?t._internalPath:t._delegate._internalPath}class qf{convertValue(e,t="none"){switch(yu(e)){case 0:return null;case 1:return e.booleanValue;case 2:return au(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cu(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw yc()}}convertObject(e,t){const n={};return Jc(e.fields,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new Mf(au(e.latitude),au(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=hu(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(lu(e));default:return null}}convertTimestamp(e){const t=ou(e);return new Pc(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Fc.fromString(e);vc(Sl(n));const r=new fu(n.get(1),n.get(3)),i=new Bc(n.popFirst(5));return r.isEqual(t)||pc(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}class zf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $f extends Vf{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Kf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Bf("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Kf extends $f{data(e={}){return super.data(e)}}class Hf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new zf(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Kf(this._firestore,this._userDataWriter,n.key,n,new zf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ic(bc.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Kf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new zf(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Kf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new zf(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Gf(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Gf(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return yc()}}function Wf(e){e=vf(e,Tf);const t=vf(e.firestore,Rf);return function(e,t,n={}){const r=new Tc;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Cf({next:s=>{t.enqueueAndForget((()=>qd(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Ic(bc.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Ic(bc.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new Hd(Zu(n.path),s,{includeMetadataChanges:!0,Nu:!0});return Bd(e,o)}(await Nf(e),e.asyncQueue,t,n,r))),r.promise}(xf(t),e._key).then((n=>function(e,t,n){const r=n.docs.get(t._key),i=new Qf(e);return new $f(e,i,t._key,r,new zf(n.hasPendingWrites,n.fromCache),t.converter)}(t,e,n)))}class Qf extends qf{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tf(this.firestore,null,t)}}!function(e,t=!0){hc="9.14.0",ue(new S("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new Rf(new Cc(e.getProvider("auth-internal")),new Dc(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Ic(bc.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new fu(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),me(cc,"3.7.3",e),me(cc,"3.7.3","esm2017")}();const Xf=pe({apiKey:"AIzaSyCbY03FNv8V7rQErFIkQDvNCaPOzs-gelE",authDomain:"vel-library-app.firebaseapp.com",projectId:"vel-library-app",storageBucket:"vel-library-app.appspot.com",messagingSenderId:"387572426127",appId:"1:387572426127:web:3158c2b7c028795aeed7fa",measurementId:"G-2TXBV01LL4"}),Jf=(function(e=ge()){const t=he(e=_(e),ot);t.isInitialized()?t.getImmediate():function(e,t={}){const n=he(e,ot);if(n.isInitialized()){const e=n.getImmediate();if(m(t,n.getOptions()))return e;throw ht.create("already-initialized")}n.initialize({options:t})}(e)}(Xf),function(e=ge()){const t=he(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=he(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(m(n.getOptions(),null!=t?t:{}))return e;Pt(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Zr,persistence:[br,rr,sr]}),r=l("authTokenSyncURL");if(r){const e=(i=r,async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ri)return;const r=null==t?void 0:t.token;ii!==r&&(ii=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){_(e).beforeAuthStateChanged(t,n)}(n,e,(()=>e(n.currentUser))),function(t,n,r,i){_(t).onIdTokenChanged((t=>e(t)),void 0,void 0)}(n)}var i;const s=h("auth");return s&&function(e,t,n){const r=xn(e);Vt(r._canInitEmulator,r,"emulator-config-failed"),Vt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Ln(t),{host:o,port:a}=function(e){const t=Ln(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Pn(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Pn(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}(n,`http://${s}`),n}(Xf)),Yf=new Gn,Zf=(e,t)=>{(async function(e,t,n){const r=xn(e);!function(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&Pt(e,"argument-error"),Ut(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(e,t,$n);const i=Er(r,void 0);return new Dr(r,"signInViaPopup",t,i).executeNotNull()})(Jf,Yf).then((t=>{console.log(t),e(t)})).catch((e=>{t("There was an issue with authentication. Please try again")}))},ep=function(e,t){const n="string"==typeof e?e:"(default)",i=he("object"==typeof e?e:ge(),"firestore").getImmediate({identifier:n});if(!i._initialized){const e=(e=>{const t=h("firestore");if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})();e&&function(e,t,n,i={}){var s;const o=(e=vf(e,If))._getSettings();if("firestore.googleapis.com"!==o.host&&o.host!==t&&gc("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},o),{host:`${t}:${n}`,ssl:!1})),i.mockUserToken){let t,n;if("string"==typeof i.mockUserToken)t=i.mockUserToken,n=uc.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",i=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},e);return[r(JSON.stringify({alg:"none",type:"JWT"})),r(JSON.stringify(o)),""].join(".")}(i.mockUserToken,null===(s=e._app)||void 0===s?void 0:s.options.projectId);const o=i.mockUserToken.sub||i.mockUserToken.user_id;if(!o)throw new Ic(bc.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new uc(o)}e._authCredentials=new Sc(new Ec(t,n))}}(i,...e)}return i}(Xf),tp=function(e,t,...n){if(e=_(e),gf("collection","path",t),e instanceof If){const r=Fc.fromString(t,...n);return yf(r),new _f(e,null,r)}{if(!(e instanceof Tf||e instanceof _f))throw new Ic(bc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Fc.fromString(t,...n));return yf(r),new _f(e.firestore,null,r)}}(ep,"users"),np=n.p+"7e8a0f93cddebdd07207.svg",rp=n.p+"ef4f161acb9eae653e1c.svg";var ip=n(379),sp=n.n(ip),op=n(795),ap=n.n(op),cp=n(569),up=n.n(cp),hp=n(565),lp=n.n(hp),dp=n(216),fp=n.n(dp),pp=n(589),gp=n.n(pp),mp=n(426),yp={};yp.styleTagTransform=gp(),yp.setAttributes=lp(),yp.insert=up().bind(null,"head"),yp.domAPI=ap(),yp.insertStyleElement=fp(),sp()(mp.Z,yp),mp.Z&&mp.Z.locals&&mp.Z.locals;const vp=(e,t,n,r)=>{const i=e,s=Number(t);let o=Number(n);return{getName:()=>i.slice(),getTot:()=>s,getRead:()=>o,style:r||!1,readPage:()=>{o=o<s?o+=1:o},unreadPage:()=>{o=0===o?o:o-=1}}},wp=e=>{const t=e||[];return{add:e=>t.push(e),remove:e=>t.splice(t.indexOf(e),1),getBooks:()=>t}},bp=(()=>{const e=e=>{const t=document.querySelector("#error");t.textContent=e,t.setAttribute("class","")},t=()=>document.querySelector("#error").setAttribute("class","hidden"),n=()=>{document.querySelectorAll("#bookinfo input").forEach((e=>e.value="")),document.querySelector("#formBackdrop").classList.toggle("hidden")},r=(e,t,n)=>{e.textContent=`${n.getRead()}/${n.getTot()}`,n.getRead()===n.getTot()?t.textContent="Finished":t.textContent="Unfinished"};return document.querySelector("#closeForm").setAttribute("src",rp),(()=>{const r=document.querySelector(".bubble"),i=document.querySelector("#closeForm"),s=document.querySelector("#submit-book"),o=document.querySelector("#login");i.addEventListener("click",n),r.addEventListener("click",(()=>{n(),t()})),s.addEventListener("click",(e=>{e.preventDefault(),Tp.addBook(),n()})),o.addEventListener("click",(()=>Zf(Tp.onLoginSuccess,e)))})(),{getBookData:()=>Array.from(document.querySelectorAll("#bookinfo input")).map((e=>e.value)),isInputComplete:e=>{const[t,n,r]=e;let i=!1;return""===t||""===n||""===r?(i="Please fill all input fields.",i):Number(n)<Number(r)?(i="Pages read cannot exceed pages total",i):isNaN(Number(r))||isNaN(Number(n))?(i="Pages must be a number",i):n<0||r<0?(i="Pages must be a positive number",i):i},showErrorDiv:e,hideErrorDiv:t,toggleForm:n,createBookDiv:e=>{const t=document.querySelector("#library"),n=document.createElement("div"),i=document.createElement("div"),s=document.createElement("div"),o=document.createElement("p"),a=document.createElement("img"),c=document.createElement("div"),u=document.createElement("p"),h=document.createElement("button"),l=document.createElement("button"),d=document.createElement("p"),f=Math.floor(3*Math.random());n.classList.add("book"),e.style||(e.style=["shadowOne","shadowTwo","shadowThree"][f]),n.classList.add(e.style),i.classList.add("deleteBook"),s.classList.add("center"),o.classList.add("title"),e.getName().split("").length>17&&o.setAttribute("style","font-size: 22px;"),a.setAttribute("src",np),a.setAttribute("alt","a fancy divider"),u.classList.add("progress"),d.classList.add("status"),i.addEventListener("click",(()=>{Tp.removeBook(e)})),h.addEventListener("click",(()=>{e.readPage(),r(u,d,e)})),l.addEventListener("click",(()=>{e.unreadPage(),r(u,d,e)})),i.textContent="x",h.textContent="+",l.textContent="-",o.textContent=e.getName(),u.textContent=`${e.getRead()}/${e.getTot()}`,e.getRead()===e.getTot()?d.textContent="Finished":d.textContent="Unfinished";const p=[o,a],g=[h,u,l],m=[s,c,d];n.appendChild(i),p.forEach((e=>s.appendChild(e))),g.forEach((e=>c.appendChild(e))),m.forEach((e=>n.appendChild(e))),t.appendChild(n)},resetLibrary:()=>document.querySelectorAll(".book").forEach((e=>e.remove())),displayUserInfo:e=>{document.querySelector("#login").setAttribute("style","display: none");const{photoUrl:t,name:n}=e,r=document.createElement("div"),i=document.createElement("img"),s=document.createElement("p");r.setAttribute("id","user-info"),i.src=t,s.textContent=`${n.split(" ")[0]}'s Library`,r.appendChild(i),r.appendChild(s),document.querySelector("#header").appendChild(r)}}})(),Ip=async e=>{const t=Sf(ep,"users",e);return(await Wf(t)).data()},Tp=(()=>{let e=wp();const t=()=>{const t=e.getBooks();for(let e=0;e<t.length;e++)bp.createBookDiv(t[e])};return{addBook:()=>{const n=bp.getBookData(),r=bp.isInputComplete(n);if(r)return void bp.showErrorDiv(r);const[i,s,o]=n,a=vp(i,s,o);e.add(a),bp.resetLibrary(),t()},removeBook:n=>{e.remove(n),bp.resetLibrary(),t()},onLoginSuccess:async n=>{const r=n.user.displayName,i=n.user.photoURL,s=n.user.uid;bp.displayUserInfo({name:r,photoUrl:i}),(t=>{const n=t.library.map((e=>vp(e.name,e.pageTot,e.pageRead,e.style))),r=wp(n);e=r})(await Ip(s)),t()}}})();(async()=>{const e=await function(e){e=vf(e,Ef);const t=vf(e.firestore,Rf),n=xf(t),r=new Qf(t);return function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Ic(bc.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query),function(e,t,n={}){const r=new Tc;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Cf({next:n=>{t.enqueueAndForget((()=>qd(e,o))),n.fromCache&&"server"===r.source?i.reject(new Ic(bc.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Hd(n,s,{includeMetadataChanges:!0,Nu:!0});return Bd(e,o)}(await Nf(e),e.asyncQueue,t,n,r))),r.promise}(n,e._query).then((n=>new Hf(t,r,e,n)))}(tp),t=await Sf(ep,"users","FNBGlmnKahWUPtij6wqiLotFh323"),n=await Wf(t);console.log(e),console.log(n.data())})()})()})();